<!DOCTYPE html>
<html lang="en" class="no-js">

  <!-- HEAD -->
<head>
<meta charset="utf-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>How to Quickly Train a Text-Generating Neural Network for Free</title>
<meta property="article:author" content="https://www.facebook.com/max.woolf" />
<meta name="description" content="One of the more interesting applications of the neural network revolution is text generation. Most popular approaches are based off of Andrej Karpathy&rsquo;...">
<link href="/rss.xml" rel="alternate" title="minimaxir | Max Woolf's Blog" type="application/atom+xml">
<link rel="canonical" href="https://minimaxir.com/2018/05/text-neural-networks/">

<!-- Mobile Metas -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">


 <meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@minimaxir">
<meta name="twitter:creator" content="@minimaxir">

  <meta name="twitter:title" content="How to Quickly Train a Text-Generating Neural Network for Free">


  <meta name="twitter:url" content="https://minimaxir.com/2018/05/text-neural-networks/">


  <meta name="twitter:description" content="Train your own text-generating neural network and generate text whenever you want with just a few clicks!">


  <meta name="twitter:image:src" content="https://minimaxir.com/img/model_config.png">

 
 <meta content="minimaxir | Max Woolf's Blog" property="og:site_name">

  <meta content="How to Quickly Train a Text-Generating Neural Network for Free" property="og:title">


  <meta content="article" property="og:type">


  <meta content="Train your own text-generating neural network and generate text whenever you want with just a few clicks!" property="og:description">


  <meta content="https://minimaxir.com/2018/05/text-neural-networks/" property="og:url">



  <meta content="https://minimaxir.com/img/model_config.png" property="og:image">


  
  <meta content="Projects" property="article:section">
  


  



      <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">

    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="white">
    <meta name="apple-mobile-web-app-title" content="minimaxir">
    <link rel="apple-touch-icon-precomposed" href="apple-touch-icon-precomposed.png">

<link rel="apple-touch-icon" sizes="57x57" href="https://minimaxir.com/favicon/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="https://minimaxir.com/favicon/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="https://minimaxir.com/favicon/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="https://minimaxir.com/favicon/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="https://minimaxir.com/favicon/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="https://minimaxir.com/favicon/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="https://minimaxir.com/favicon/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="https://minimaxir.com/favicon/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="https://minimaxir.com/favicon/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="https://minimaxir.com/favicon/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://minimaxir.com/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="https://minimaxir.com/favicon/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://minimaxir.com/favicon/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="https://minimaxir.com/favicon/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">

<!-- BEGIN GLOBAL MANDATORY STYLES -->
  <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,300italic,400,400italic,700' rel='stylesheet' type='text/css'>

<link href="/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
<link href="/css/minimaxir.css" rel="stylesheet" type="text/css"/>
<!-- END GLOBAL MANDATORY STYLES -->

<!-- BEGIN THEME STYLES -->
<link href="/css/global.css" rel="stylesheet" type="text/css"/>
<!-- END THEME STYLES -->

<!-- BEGIN JQUERY -->
<script type="text/javascript" src="/js/jquery.min.js"></script>
<!-- END JQUERY -->



  <script>
   $(document).ready(function() {
 
  // LinkedIn
	$( ".social.linkedin" ).children().each(function(index,value) {
	var linkedin_button = $(this);
	var url = linkedin_button.attr("data");

  jQuery.getJSON("https://www.linkedin.com/countserv/count/share?url="+url+"&format=jsonp&callback=?", function(data) {
  linkedin_button.html("<i class=\"fa fa-linkedin\"></i><span class=\"count hidden-xs\"> " + data.count + "</span>");
  });
  });
  });
  </script>
  
</head>
<!-- END HEAD -->
  <!-- WRAPPER -->
<div class="wrapper">
    <!--========== HEADER TRANSPARENT ==========-->
    <header class="header-transparent header-transparent-bb navbar-fixed-top header-sticky">
        <!-- Navbar -->
        <nav class="navbar mega-menu" role="navigation">
            <div class="container">
                <!-- Brand and toggle get grouped for better mobile display -->
                <div class="menu-container">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="toggle-icon"></span>
                    </button>

                    <!-- Navbar Actions -->
                    <div class="navbar-actions">

                    </div>
                    <!-- End Navbar Actions -->

                    <!-- Logo -->
                    <div class="navbar-logo">
                        <a class="navbar-logo-wrap" href="/">
                            <img class="navbar-logo-img navbar-logo-img-white" src="/minimaxir-light.png" alt="minimaxir">
                            <img class="navbar-logo-img navbar-logo-img-dark" src="/minimaxir-dark.png" alt="minimaxir">
                        </a>
                    </div>
                    <!-- End Logo -->
                </div>

                <!-- Collect the nav links, forms, and other content for toggling -->
                <div class="collapse navbar-collapse nav-collapse">
                    <div class="menu-container">
                        <ul class="nav navbar-nav">

                            <li class="nav-item">
                                <a class="nav-item-child" href="/about">
                                    About
                                </a>
                            </li>

                            <li class="nav-item">
                                <a class="nav-item-child" href="/portfolio">
                                    Code Portfolio
                                </a>


                            </li>
                            <li class="nav-item">
                                <a class="nav-item-child" href="/data-portfolio">
                                    Data Portfolio
                                </a>


                            </li>
                             <li class="nav-item">
                                <a class="nav-item-child" href="https://www.patreon.com/minimaxir" target="_blank">
                                    Patreon
                                </a>


                            </li>

                        </ul>
                    </div>
                </div>
                <!-- End Navbar Collapse -->
            </div>
            <!--// End Container-->
        </nav>
        <!-- Navbar -->
    </header>
    <!--========== END HEADER TRANSPARENT ==========-->

        <!--========== BREADCRUMBS V5 ==========-->
    
    
	
	
    
    
    
    <section class="breadcrumbs-v5" style="background: url('/img/model_config.png') no-repeat center center; background-size: cover;">
    
        <div class="container">
            <h1 class="breadcrumbs-v5-title">How to Quickly Train a Text-Generating Neural Network for Free</h1>
            <span class="breadcrumbs-v5-subtitle">May 18, 2018
            
    
              <span class="sharing index" style="float: right">
  
		  <span class="social facebook"><a href="https://www.facebook.com/share.php?u=https://minimaxir.com/2018/05/text-neural-networks/"  onclick="javascript:window.open(this.href,
  '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=350,width=600');return false;" data="https://minimaxir.com/2018/05/text-neural-networks/"><i class="fa fa-facebook"></i><span class="count hidden-xs"></span></a></span>
  
		<span class="social twitter"><a href="https://twitter.com/home/?status=How to Quickly Train a Text-Generating Neural Network for Free - https://minimaxir.com/2018/05/text-neural-networks/ - via @minimaxir"  onclick="javascript:window.open(this.href,
  '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=350,width=600');return false;" data=https://minimaxir.com/2018/05/text-neural-networks/><i class="fa fa-twitter"></i><span class="count hidden-xs"></span></a> </span>

  <span  class="social linkedin"><a href="https://www.linkedin.com/shareArticle?mini=true&title=&url=https://minimaxir.com/2018/05/text-neural-networks/"  onclick="javascript:window.open(this.href,
  '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=450,width=600');return false;" data=https://minimaxir.com/2018/05/text-neural-networks/><i class="fa fa-linkedin"></i><span class="count hidden-xs"> -</span></a> </span>
   
			</span>
            
            </span>
        </div>
    </section>
    
    
    <!--========== END BREADCRUMBS V5 ==========-->
  
  <!-- BEGIN BODY -->
<body>

  
      <!--========== BACKGROUND COLOR SKY LIGHT ==========-->
    <div class="bg-color-sky-light">

        
        <!--========== PAGE CONTENT ==========-->
        <div class="content-sm container">
        
            
			<div class="row">
			<div class="col-md-12 md-margin-b-50">
			<div style="row">
    <div class="col-sm-10 col-sm-offset-1 col-xs-12 col-xs-offset-0" style="padding: 0 0 0 0;">
            <div class="responsive-video"><iframe src="http://www.youtube.com/embed/RW7mP6BfZuY " style="width: 100%; height: 100%; border: none; padding-bottom: 20px" allowfullscreen></iframe></div>

    </div>
</div>

<div style="row">
    <div class="col-sm-10 col-sm-offset-1 col-xs-12 col-xs-offset-0 margin-b-20">

        <div class="heading-v1 text-center margin-b-20  margin-t-20">
            <h3 class="heading-v1-title">My video on how to quickly train your own text-generating neural network using a Colaboratory Notebook. Watch in 4K!
            </h3>
        </div>

    </div>
</div>
			</div>
			</div>
			
		
        
            <div class="row">
                <div class="col-md-9 md-margin-b-50">
                    <!-- Blog Grid -->
                    <article class="blog-grid margin-b-30">
                        <!-- Image -->
                        <!--<img class="img-responsive" src="/assets/img/1920x1080/20.jpg" alt="">-->
                        <!-- End Image -->

                        <!-- Blog Grid Content -->
						<div class="blog-grid-content">
						<p>One of the more interesting applications of the neural network revolution is text generation. Most popular approaches are based off of Andrej Karpathy&rsquo;s <a href="https://github.com/karpathy/char-rnn">char-rnn architecture</a>/<a href="http://karpathy.github.io/2015/05/21/rnn-effectiveness/">blog post</a>, which teaches a recurrent neural network to be able to predict the next character in a sequence based on the previous <em>n</em> characters. As a result, a sufficiently trained network can theoretically reproduce its input source material, but since properly-trained neural networks aren&rsquo;t <em>perfect</em>, the output can fall into a weird-but-good uncanny valley.</p>

<p><img src="/img/text-neural-networks/textgenrnn_console.gif" alt=""></p>

<p>Many internet tutorials for text-generation neural networks simply copy an existing char-rnn implementation while changing the input dataset. It&rsquo;s one approach, but there&rsquo;s an opportunity for improvement with modern deep learning tooling. Thanks to frameworks like <a href="https://www.tensorflow.org">TensorFlow</a> and <a href="https://github.com/keras-team/keras">Keras</a>, I built <a href="https://github.com/minimaxir/textgenrnn">textgenrnn</a>, a <a href="https://pypi.org/project/textgenrnn/#description">Python package</a> which abstracts the process of creating and training such char-rnns to a <em>few lines of code</em>, with numerous model architecture and training improvements such as <a href="http://minimaxir.com/2017/04/char-embeddings/">character embeddings</a>, attention-weighted averaging, and a decaying learning rate.</p>

<p>A neat benefit of textgenrnn is that it can be easily used to train neural networks on a GPU very quickly, <em>for free</em> using <a href="https://colab.research.google.com/notebooks/welcome.ipynb">Google Colaboratory</a>. I&rsquo;ve <a href="https://drive.google.com/file/d/1mMKGnVxirJnqDViH7BDJxFqWrsXlPSoK/view?usp=sharing">created a notebook</a> which lets you train your own network and generate text whenever you want with just a few clicks!</p>

<h2>Your First Text-Generating Neural Network</h2>

<p>Colaboratory is a notebook environment similar to <a href="http://jupyter.org">Jupyter Notebooks</a> used in other data science projects. However, Colaboratory notebooks are hosted in a short term virtual machine, with 2 vCPUs, 13GB memory, and a K80 GPU attached. For free. Normally, this configuration would <a href="https://cloud.google.com/compute/pricing">cost</a> $0.57/hr on Google Compute Engine; it sounds low, but adds up when you need to train model(s) for hours to get good results.</p>

<p>First, I recommend copying the notebook to your own Drive so it&rsquo;ll always be there (and switch to using Google Chrome if you aren&rsquo;t). The Colaboratory VM contains Python 3 and common Python packages for machine learning such as TensorFlow. But you can install more packages directly in the notebook. Like textgenrnn! Just run this cell by clicking into the cell and click the &ldquo;play&rdquo; button (or use Shift + Enter) and it&rsquo;ll take care of the rest:</p>

<p><img src="/img/text-neural-networks/pip.png" alt=""></p>

<p>When training a new model, textgenrnn allows you to specify the size and complexity of the neural network with a wide variety of parameters:</p>

<p><img src="/img/text-neural-networks/config.png" alt=""></p>

<p>Let&rsquo;s keep these default parameters for now, so run that cell to load them into memory. Run the next cell, which prompts you to upload a file. <em>Any text file should work</em>, even large text files! For this example, we&rsquo;ll use a 1.1MB text file of Shakespeare plays also <a href="https://github.com/karpathy/char-rnn/tree/master/data/tinyshakespeare">used in the char-rnn demos</a>.</p>

<p><img src="/img/text-neural-networks/upload.png" alt=""></p>

<p>The next cell initializes an instance of textgenrnn and begins training a custom new text-generating neural network!</p>

<p><img src="/img/text-neural-networks/train.png" alt=""></p>

<p>textgenrnn automatically processes the input text into character sequences ready to train the network. After every 2 epochs (a full pass through the data), the network will generate sample text at different temperatures, which represent the &ldquo;creativity&rdquo; of the text (i.e. it allows the model to make increasingly suboptimal predictions, which can cause hilarity to ensue). I typically like generating text at a temperature of 0.5, but for very well-trained models, you can go up to 1.0.</p>

<p>The quick model training speed comes from the VM&rsquo;s GPU, which can perform the necessary mathematical operations much faster than with a CPU. However, in the case of recurrent neural networks, Keras recently added a <a href="https://keras.io/layers/recurrent/#cudnnlstm">CuDNN implementation of RNNs</a> like LSTMs, which can easily tap into the GPU-native code more easily and gain a <em>massive</em> speed boost (<a href="http://minimaxir.com/2017/11/benchmark-gpus/">about <em>7x as fast</em></a>) compared to previous implementations! In all, for this example dataset and model architecture, training on a GPU took 5-6 minutes an epoch, while on a modern CPU, training took <em>1 hour and 24 minutes</em> an epoch, a <strong>14x speedup</strong> on the GPU!</p>

<p>After training is complete, running the next cell will download three files: a <code>weights</code> file, a <code>vocabulary</code> file, and a <code>config</code> file that are all needed to regenerate your model elsewhere.</p>

<p><img src="/img/text-neural-networks/download.png" alt=""></p>

<p>For example, on your own personal computer. Just install textgenrnn + TensorFlow by inputting <code>pip3 install textgenrnn tensorflow</code> into a terminal, change to the directory where the downloaded files are located, run <code>python3</code>, and load the model using:</p>
<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">textgenrnn</span> <span class="kn">import</span> <span class="n">textgenrnn</span>
<span class="n">textgen</span> <span class="o">=</span> <span class="n">textgenrnn</span><span class="p">(</span><span class="n">weights_path</span><span class="o">=</span><span class="s">'colaboratory_weights.hdf5'</span><span class="p">,</span>
                       <span class="n">vocab_path</span><span class="o">=</span><span class="s">'colaboratory_vocab.json'</span><span class="p">,</span>
                       <span class="n">config_path</span><span class="o">=</span><span class="s">'colaboratory_config.json'</span><span class="p">)</span>
</code></pre></div>
<p>And that&rsquo;s that! No GPU necessary if you&rsquo;re just generating text. You can generate samples (like during training) using <code>textgen.generate_samples()</code>, generate a ton of samples at any temperature you like to a file using <code>textgen.generate_to_file()</code>, or incorporate a generated text into a Python script (e.g. a Twitter bot) using <code>textgen.generate(1, return_as_list=True)[0]</code> to store a text as a variable. You can view more of textgenrnn&rsquo;s functions and capabilities in <a href="https://github.com/minimaxir/textgenrnn/blob/master/docs/textgenrnn-demo.ipynb">this demo Jupyter Notebook</a>.</p>

<p>Here&rsquo;s some Shakespeare generated with a 50-minute-trained model at a temperature of 0.5:</p>
<div class="highlight"><pre><code class="language-" data-lang="">LUCENTIO:
And then shall good grave to my wife thee;
Thou would the cause the brieved to me,
And let the place and then receives:
The rest you the foren to my ways him child,
And marry that will be a parties and so set me that be deeds
And then the heart and be so shall make the most as he and stand of seat.

GLOUCESTER:
Your father and madam, or shall for the people
And dead to make the truth, or a business
As we brother to the place her great the truth;
And that which to the smaster and her father,
I am I was see the sun have to the royal true.
</code></pre></div>
<p>Not too bad, and it&rsquo;s even close to <a href="https://en.wikipedia.org/wiki/Iambic_pentameter">iambic pentameter</a>!</p>

<h2>Tweaking the Model</h2>

<p>The most important model configuration options above are <code>rnn_size</code> and <code>rnn_layers</code>: these determine the complexity of the network. Typically, you&rsquo;ll see networks in tutorials be a single 128-cell or 256-cell network. However, textgenrnn&rsquo;s architecture is slightly different as it has an attention layer which incorporates <em>all</em> the preceding model layers. As a result, it&rsquo;s  much better to go deeper than wider (e.g. 4x128 is better than 1x512) unless you have a very large amount of text (&gt;10MB). <code>rnn_bidirectional</code> controls whether the recurrent neural network is bidirectional, that is, it processes  the previous characters both forward <em>and</em> backward (which works great if text follows specific rules, like Shakespeare&rsquo;s character headings). <code>max_length</code> determines the maximum number of characters for the network to use to predict the next character, which should be increased to let the network learn longer sequences, or decrease for shorter sequences.</p>

<p>Training has a few helpful options as well. <code>num_epochs</code> determines the number of full passes of the data; this can be tweaked if you want to train the model even more. <code>batch_size</code> determines the number of model sequences to train in a step: typically, batch size for deep learning models is 32 or 128, but with a GPU, you can get a speed increase by saturating it with the given 1024 default. <code>train_size</code> determines the proportion of character samples to train; setting it <code>&lt; 1.0</code> both speeds up each epoch, and prevents the model from cheating and being able to learn sequences verbatim. (You can set <code>&#39;validation&#39;: True</code> to run the model on the unused data after each epoch to see if the model is overfitting).</p>

<p>Let&rsquo;s try playing with the parameters more on a new text dataset.</p>

<h2>Word-Level Text Generation With Reddit Data</h2>

<p>You might be asking &ldquo;how do you obtain text data&rdquo;? The popular text-generation use cases like lyric generation and movie scripts are copyright-protected so they&rsquo;re harder to find, and even then, it might not be enough text data to train a new model upon (you typically want atleast 100,000 characters).</p>

<p><a href="https://www.reddit.com">Reddit</a>, however, has <em>millions</em> of submission titles which would be great to train for a model. I wrote a <a href="https://github.com/minimaxir/subreddit-generator">helper script</a> to automatically download the top <em>n</em> Reddit submissions from a given subreddit over a given period of time. If you choose subreddits with similar linguistic styles in their titles, the subreddits will even blend together! Let&rsquo;s play with the Top 20,000 Submissions in 2017 from each of <a href="https://www.reddit.com/r/politics/">/r/politics</a> and <a href="https://www.reddit.com/r/technology/">/r/technology</a>, which results in a 3.3MB file: about 3x as much data as the Shakespeare plays.</p>

<p><img src="/img/text-neural-networks/reddit_data.png" alt=""></p>

<p>One last thing that textgenrnn can do that most char-rnn implementations can&rsquo;t is generate a <em>word level</em> model (thanks to Keras&rsquo;s tokenizers), where the model uses the <em>n</em> previous words/punctuation to predict the next word/punctuation. On the plus side, using only words prevents crazy typoes and since it predicts multiple &ldquo;characters&rdquo; at a time, <code>max_length</code> can be reduced proportionally, dramatically speeding up training. There&rsquo;s two downsides with this approach; since words are all lowercase and punctuation is its own token, the generated text cannot be immediately used without manual editing. Additionally, the model weights will be substantially larger than a character-level model since the word-level model has to store an embedding for each word (up to <code>max_words</code>, which is 10,000 by default when the vocabulary size for a char-level model is 200-300).</p>

<p>Another advantage of the Colaboratory notebook is that you can quickly adjust model parameters, upload a new file, and immediately start training it. We&rsquo;ll set <code>&#39;line_delimited&#39;: True</code> and <code>&#39;rnn_bidirectional&#39;: False</code> since there aren&rsquo;t specific rules. For word level training, let&rsquo;s set <code>&#39;word_level&#39;: True</code> and <code>&#39;max_length&#39;: 8</code> to reflect the new training architecture. Since training length has been reduced to 1/5th, we can set <code>&#39;num_epochs&#39;: 50</code> and <code>&#39;gen_epoch&#39;: 10</code> to balance it out. Rerun the config cell to update parameters, upload the Reddit data file, and rerun training.</p>

<p>The resulting model is much more well trained than the Shakespeare model, and here&rsquo;s a few Reddit submission titles generated at a temperature of 1.0:</p>
<div class="highlight"><pre><code class="language-" data-lang="">report : 49 % of americans now believe all of the country ’ s effective

people like facebook like it ' s 650 of 1 %

uber accused of secretly - security popular service ( likely oklahoma )

equifax breach fallout : your salary is dead

sanders uses texas shooter ' s iphone sales

adobe videos will be used to sell the web

apple to hold cash for $ 500 service

fitbit just targeting solar energy

george bush ' s concept car ‘ goes for all the biggest controversy .
</code></pre></div>
<p>Those look pretty good, although they may need a little editing before posting on social media.</p>

<h2>Followup</h2>

<p>These examples only train the model for little time as a demo of textgenrnn&rsquo;s fast learning; there&rsquo;s nothing stopping you from increasing <code>num_epochs</code> even more to further refine a model. However, from my experience, the training cell times out after <strong>4 hours</strong>; set <code>num_epochs</code> accordingly, although in my experience that&rsquo;s all you need before the network converges.</p>

<p>In practice, I used this Colaboratory notebook to train <em>many</em> models for <a href="https://www.reddit.com/r/SubredditNN/">/r/SubredditNN</a>, a Reddit subreddit where only text-generating neural network bots trained on other subreddits. And the results are very funny:</p>

<p><img src="/img/text-neural-networks/subredditnn.png" alt=""></p>

<p>Although text generating neural networks aren&rsquo;t at the point where they can <a href="https://www.bloomberg.com/news/features/2018-05-17/i-tried-to-get-an-ai-to-write-this-story-paul-ford">write entire articles by themselves</a>, there are still many opportunities to use it just for fun! And thanks to textgenrnn, it&rsquo;s easy, fast, and cost-effective for anyone to do! Let me know if you make any interesting neural networks with textgenrnn and this Notebook!</p>

                        
                        
                        <div class="alert alert-warning" role="alert">

     <p>If you liked this blog post, I have set up a <a href="https://www.patreon.com/minimaxir">Patreon</a> to fund my machine learning/deep learning/software/hardware needs for my future crazy yet cool projects, and any monetary contributions to the Patreon are appreciated and will be put to good creative use.</p>

    
</div>
                        
						
            			 <div class="breadcrumbs-v5-subtitle sharing-post" style="color: #999 !important; padding-top:10px; border-top: 1px solid #eee">Share this article!


              <span class="sharing index" style="float: right; color: #999 !important;">
  
		  <span class="social facebook"><a href="https://www.facebook.com/share.php?u=https://minimaxir.com/2018/05/text-neural-networks/"  onclick="javascript:window.open(this.href,
  '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=350,width=600');return false;" data="https://minimaxir.com/2018/05/text-neural-networks/"><i class="fa fa-facebook"></i><span class="count hidden-xs"></span></a></span>
  
		<span class="social twitter"><a href="https://twitter.com/home/?status=How to Quickly Train a Text-Generating Neural Network for Free - https://minimaxir.com/2018/05/text-neural-networks/ - via @minimaxir"  onclick="javascript:window.open(this.href,
  '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=350,width=600');return false;" data=https://minimaxir.com/2018/05/text-neural-networks/><i class="fa fa-twitter"></i><span class="count hidden-xs"></span></a> </span>

  <span  class="social linkedin"><a href="https://www.linkedin.com/shareArticle?mini=true&title=&url=https://minimaxir.com/2018/05/text-neural-networks/"  onclick="javascript:window.open(this.href,
  '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=450,width=600');return false;" data=https://minimaxir.com/2018/05/text-neural-networks/><i class="fa fa-linkedin"></i><span class="count hidden-xs"> -</span></a> </span>

   </span>
   </div>
						</div>
                        <!-- End Blog Grid Content -->
                        
                        
                        
                    </article>
                    <!-- End Blog Grid -->

 					

                    <!-- Blog Comment -->
                    <div class="blog-comments bg-color-white margin-b-30">
                        <div class="blog-single-post-content">

						

<script type="text/javascript">
      var disqus_shortname = 'minimaxir';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'https://minimaxir.com/2018/05/text-neural-networks/';
        var disqus_url = 'https://minimaxir.com/2018/05/text-neural-networks/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>

<div id="disqus_thread"></div>



                        </div>
                    </div>
                    <!-- End Blog Comment -->
                    
                    
                </div>

			<!--========== BLOG SIDEBAR ==========-->
<div class="col-md-3">



    <!-- Blog Author -->
    <div class="blog-sidebar margin-b-30">
        <div class="blog-sidebar-heading">
            <h4 class="blog-sidebar-heading-title">Author</h4>
        </div>

        <img src="/MaxFB.jpg" title="Stop mousing over me! I'm not a XKCD comic!" class="img-responsive hidden-xs hidden-sm"></img>

        <div class="blog-sidebar-content">
            <!-- Blog Author Bio -->
             <p><strong>Max Woolf (@minimaxir)</strong> is a Data Scientist at BuzzFeed in San Francisco. He is also an ex-Apple employee and Carnegie Mellon University graduate.</p>

<p>In his spare time, Max uses <a href="https://www.python.org/">Python</a> to gather data from public APIs and <a href="http://ggplot2.org/">ggplot2</a> to plot plenty of pretty charts from that data. On special occasions, he uses <a href="https://github.com/fchollet/keras">Keras</a> for fancy deep learning projects.</p>

<p>You can learn more about Max <a href="/about">here</a>, view his data analysis portfolio <a href="/data-portfolio">here</a>, or view his coding portfolio <a href="/portfolio">here</a>. </p>


            <ul class="list-inline" style="padding-top:10px; margin-top: 20px; border-top: 1px solid #ebeef6">
                <li class="theme-icons-wrap"><a title="Facebook" href="https://facebook.com/max.woolf" target="_blank"><i class="theme-icons theme-icons-grey-light-bg theme-icons-xs radius-circle fa fa-facebook"></i></a></li>
                <li class="theme-icons-wrap"><a title="Twitter" href="https://twitter.com/minimaxir" target="_blank"><i class="theme-icons theme-icons-grey-light-bg theme-icons-xs radius-circle fa fa-twitter"></i></a></li>
                <li class="theme-icons-wrap"><a title="LinkedIn" href="https://linkedin.com/in/minimaxir" target="_blank"><i class="theme-icons theme-icons-grey-light-bg theme-icons-xs radius-circle fa fa-linkedin"></i></a></li>
                <li class="theme-icons-wrap"><a title="E-Mail" href="mailto:max@minimaxir.com"><i class="theme-icons theme-icons-grey-light-bg theme-icons-xs radius-circle fa fa-envelope"></i></a></li>
                <li class="theme-icons-wrap"><a title="GitHub" href="https://github.com/minimaxir" target="_blank"><i class="theme-icons theme-icons-grey-light-bg theme-icons-xs radius-circle fa fa-github"></i></a></li>
                <li class="theme-icons-wrap"><a title="YouTube" href="https://youtube.com/minimaxir" target="_blank"><i class="theme-icons theme-icons-grey-light-bg theme-icons-xs radius-circle fa fa-youtube"></i></a></li>
                <li class="theme-icons-wrap"><a title="RSS" href="/rss.xml"><i class="theme-icons theme-icons-grey-light-bg theme-icons-xs radius-circle fa fa-rss"></i></a></li>
            </ul>
            <!-- End Blog Author Bio -->
        </div>
    </div>
    <!-- End Blog Author -->

    <!-- Blog Recent Posts -->
    <div class="blog-sidebar margin-b-30">
        <div class="blog-sidebar-heading">
            <h4 class="blog-sidebar-heading-title">Recent Posts</h4>
        </div>
        <div class="blog-sidebar-content" style="position: relative; overflow: visible;">

            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="/2018/10/data-science-protips/">Things About Real-World Data Science Not Discussed In MOOCs and Thought Pieces</a></h5>
                    <small class="latest-tuts-content-time"> Oct 22, 2018</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="/2018/09/modeling-link-aggregators/">Problems with Predicting Post Performance on Reddit and Other Link Aggregators</a></h5>
                    <small class="latest-tuts-content-time"> Sep 10, 2018</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="/2018/07/imdb-data-analysis/">Analyzing IMDb Data The Intended Way, with R and ggplot2</a></h5>
                    <small class="latest-tuts-content-time"> Jul 16, 2018</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="/2018/05/text-neural-networks/">How to Quickly Train a Text-Generating Neural Network for Free</a></h5>
                    <small class="latest-tuts-content-time"> May 18, 2018</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="/2018/03/basketball-shots/">Visualizing One Million NCAA Basketball Shots</a></h5>
                    <small class="latest-tuts-content-time"> Mar 19, 2018</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="/2018/02/stack-overflow-questions/">A Visual Overview of Stack Overflow's Question Tags</a></h5>
                    <small class="latest-tuts-content-time"> Feb 9, 2018</small>
                </div>
            </article>
            
        </div>
        <!-- End Blog Recent Posts -->
    </div>

    <!-- GitHub Top Repositories -->
    <div class="blog-sidebar margin-b-30">
        <div class="blog-sidebar-heading">
            <h4 class="blog-sidebar-heading-title">GitHub Code Repositories</h4>
        </div>
        <div class="blog-sidebar-content" style="position: relative; overflow: visible;">

            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="http://github.com/minimaxir/big-list-of-naughty-strings" target="_blank">Big List of Naughty Strings</a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-star"></i> 21,523+</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="http://github.com/minimaxir/facebook-page-post-scraper" target="_blank">Facebook Page Post Scraper</a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-star"></i> 1,436+</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="http://github.com/minimaxir/textgenrnn" target="_blank">textgenrnn</a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-star"></i> 234+</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="http://github.com/minimaxir/reactionrnn" target="_blank">reactionrnn</a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-star"></i> 201+</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="http://github.com/minimaxir/system-dashboard" target="_blank">Multiplatform System Dashboard</a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-star"></i> 100+</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="http://github.com/minimaxir/tritonize" target="_blank">Tritonize</a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-star"></i> 9+</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="http://github.com/minimaxir/stylistic-word-clouds" target="_blank">Stylistic Word Clouds</a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-star"></i> 30+</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="http://github.com/minimaxir/char-embeddings" target="_blank">Pretrained Character Embeddings for Deep Learning and Automatic Text Generation</a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-star"></i> 8+</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="http://github.com/minimaxir/get-profile-data-of-repo-stargazers" target="_blank">Get GitHub Profile Data of All Stargazers of a GitHub Repo</a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-star"></i> 15+</small>
                </div>
            </article>
            
        </div>
    </div>

    <!-- End GitHub Top Repositories -->

    <!-- Data Top Repositories -->
    <div class="blog-sidebar margin-b-30">
        <div class="blog-sidebar-heading">
            <h4 class="blog-sidebar-heading-title">Data Analysis Notebooks</h4>
        </div>
        <div class="blog-sidebar-content" style="position: relative; overflow: visible;">

            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="http://minimaxir.com/notebooks/imgur-decline/" target="_blank">The Decline of Imgur on Reddit and the Rise of Reddit's Native Image Hosting</a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-cogs"></i> R, ggplot2</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="http://minimaxir.com/notebooks/keras-cntk/" target="_blank">Benchmarking CNTK on Keras: is it Better at Deep Learning than TensorFlow?</a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-cogs"></i> R, ggplot2</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="http://minimaxir.com/notebooks/char-tsne/" target="_blank">Pretrained Character Embeddings for Deep Learning and Automatic Text Generation</a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-cogs"></i> R, ggplot2</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="http://minimaxir.com/notebooks/predicting-arrests/" target="_blank">Predicting And Mapping Arrest Types in San Francisco</a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-cogs"></i> R, ggplot2, LightGBM</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="http://minimaxir.com/notebooks/amazon-spark/" target="_blank">Playing with 80 Million Amazon Product Review Ratings</a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-cogs"></i> R, ggplot2, Spark</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="http://minimaxir.com/notebooks/interactive-network/" target="_blank">How to Create an Interactive WebGL Network Graph</a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-cogs"></i> R, ggplot2, plotly</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="http://minimaxir.com/notebooks/first-comment/" target="_blank">What Percent of the Top-Voted Comments in Reddit Threads Were Also 1st Comment?</a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-cogs"></i> R, ggplot2</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="https://github.com/minimaxir/clickbait-cluster/blob/master/fb_news_53D_spark.ipynb" target="_blank">Processing Clusters of Clickbait Headlines </a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-cogs"></i> Python, Spark, word2vec</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="https://github.com/minimaxir/clickbait-cluster/blob/master/fb_news_53D_plotly.ipynb" target="_blank">Visualizing Clusters of Clickbait Headlines </a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-cogs"></i> R, plotly</small>
                </div>
            </article>
            
        </div>
    </div>

    <!-- End GitHub Top Repositories -->



</div>
<!--========== END BLOG SIDEBAR ==========-->
			</div>
            <!--// end row -->
        </div>
        <!--========== END PAGE CONTENT ==========-->

    </div>
    <!--========== END BACKGROUND COLOR SKY LIGHT ==========-->
    



  
              <div class="wrapper">
    
	
	
    	 <section class="breadcrumbs-v5 bg-position-fixed" style="background: #2c3e50;  padding: 20px 0 20px !important;">
        <div class="container">
            <div class="row hero-index">
            <div class="col-sm-6 sm-margin-b-30 hidden-xs">
                <img src="/MaxFBInvert.png" title="Stop mousing over me! I'm not a XKCD comic!" class="img-responsive" style="border-radius: 30px; margin: 0 auto; max-height: 400px"></img>
            </div>
            <div class="col-sm-6 col-xs-12">

			
			<p><strong>Max Woolf (@minimaxir)</strong> is a Data Scientist at BuzzFeed in San Francisco. He is also an ex-Apple employee and Carnegie Mellon University graduate.</p>

<p>In his spare time, Max uses <a href="https://www.python.org/">Python</a> to gather data from public APIs and <a href="http://ggplot2.org/">ggplot2</a> to plot plenty of pretty charts from that data. On special occasions, he uses <a href="https://github.com/fchollet/keras">Keras</a> for fancy deep learning projects.</p>

<p>You can learn more about Max <a href="/about">here</a>, view his data analysis portfolio <a href="/data-portfolio">here</a>, or view his coding portfolio <a href="/portfolio">here</a>. </p>

  
  
  <ul class="list-inline" style="padding-top:20px; margin-top: 40px; border-top: 1px solid white;">
                        <li class="theme-icons-wrap"><a title="Facebook" href="https://facebook.com/max.woolf" target="_blank"><i class="theme-icons theme-icons-white-brd theme-icons-md radius-circle fa fa-facebook"></i></a></li>
                        <li class="theme-icons-wrap"><a title="Twitter" href="https://twitter.com/minimaxir" target="_blank"><i class="theme-icons theme-icons-white-brd theme-icons-md radius-circle fa fa-twitter"></i></a></li>
                        <li class="theme-icons-wrap"><a title="LinkedIn" href="https://linkedin.com/in/minimaxir" target="_blank"><i class="theme-icons theme-icons-white-brd theme-icons-md radius-circle fa fa-linkedin"></i></a></li>
                        <li class="theme-icons-wrap"><a title="E-Mail" href="mailto:max@minimaxir.com"><i class="theme-icons theme-icons-white-brd theme-icons-md radius-circle fa fa-envelope"></i></a></li>
                        <li class="theme-icons-wrap"><a title="GitHub" href="https://github.com/minimaxir" target="_blank"><i class="theme-icons theme-icons-white-brd theme-icons-md radius-circle fa fa-github"></i></a></li>
                        <li class="theme-icons-wrap"><a title="YouTube" href="https://youtube.com/minimaxir" target="_blank"><i class="theme-icons theme-icons-white-brd theme-icons-md radius-circle fa fa-youtube"></i></a></li>
                        <li class="theme-icons-wrap"><a title="RSS" href="/rss.xml"><i class="theme-icons theme-icons-white-brd theme-icons-md radius-circle fa fa-rss"></i></a></li>

                    </ul>
            </div>
        </div>
        </div>
    </section>
    
	

	
    

            </div>
    
    <!--========== FOOTER V8 ==========-->
    <footer id="footer" class="footer-v8">



        <!-- Copyright -->
        <div class="footer-v8-copyright">
            <div class="container text-center">
				Copyright &#169; 2018 Max Woolf. All Rights Reserved. 
                minimaxir.com is powered by Jekyll and GitHub Pages.
            </div>
        </div>
        <!-- Copyright -->
    </footer>
    <!--========== END FOOTER V8 ==========-->
</div>
<!-- END WRAPPER -->

<!-- Sidebar Content Overlay -->
<div class="sidebar-content-overlay"></div>
<!-- End Sidebar Content Overlay -->

<!-- Back To Top -->
<a href="javascript:void(0);" class="js-back-to-top back-to-top-theme"></a>
<!-- End Back To Top -->

<!--========== JAVASCRIPTS(Load javascripts at bottom, this will reduce page load time) ==========-->
<!-- BEGIN CORE PLUGINS -->
<!--[if lt IE 9]>
<script src="/assets/plugins/html5shiv.js"></script>
<script src="/assets/plugins/respond.min.js"></script>
<![endif]-->
<script type="text/javascript" src="/js/jquery.migrate.min.js"></script>
<script type="text/javascript" src="/js/bootstrap.min.js"></script>
<!-- END CORE PLUGINS -->

<!-- BEGIN PAGE LEVEL PLUGINS -->
<script type="text/javascript" src="/js/jquery.back-to-top.js"></script>
<!-- END PAGE LEVEL PLUGINS -->

<!-- BEGIN PAGE LEVEL SCRIPTS -->
<script type="text/javascript" src="/js/app.min.js"></script>
<script type="text/javascript" src="/js/header-sticky.js"></script>
<!-- END PAGE LEVEL SCRIPTS -->


<!--========== END JAVASCRIPTS ==========-->
  
</body>
<!-- END BODY -->

</html>