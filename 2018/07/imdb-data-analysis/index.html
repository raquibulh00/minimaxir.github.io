<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Source Themes Academic 4.3.1"><meta name=author content="Max Woolf"><meta name=description content="For IMDb's big-but-not-big data, you have to play with the data smartly, and both R and ggplot2 have neat tricks to do just that."><link rel=alternate hreflang=en-us href=https://minimaxir.com/2018/07/imdb-data-analysis/><meta name=theme-color content=#2962ff><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin=anonymous><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.6.0/css/all.css integrity=sha384-aOkxzJ5uQz7WBObEZcHvV5JvRW3TUc2rNPA7pe3AwnsUohiw1Vj2Rgx2KSOkF5+h crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/github.min.css crossorigin=anonymous title=hl-light><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/dracula.min.css crossorigin=anonymous title=hl-dark disabled><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400italic,700|Source+Code+Pro:400,400italic,700&display=swap"><link rel=stylesheet href=/css/academic.min.4cdedb6ca5fc8a13caf3e26423bf7037.css><link rel=stylesheet href=/css/academic.59da4f61e2de6d8a5935b902fe667ab3.css><link rel=manifest href=/site.webmanifest><link rel=icon type=image/png href=/img/icon.png><link rel=apple-touch-icon type=image/png href=/img/icon-192.png><link rel=canonical href=https://minimaxir.com/2018/07/imdb-data-analysis/><meta property=twitter:card content=summary_large_image><meta property=twitter:site content=@minimaxir><meta property=twitter:creator content=@minimaxir><meta property=article:author content=https://www.facebook.com/max.woolf><meta property=og:site_name content="Max Woolf's Blog"><meta property=og:url content=https://minimaxir.com/2018/07/imdb-data-analysis/><meta property=og:type content=article><meta property=og:title content="Analyzing IMDb Data The Intended Way, with R and ggplot2"><meta property=og:description content="For IMDb's big-but-not-big data, you have to play with the data smartly, and both R and ggplot2 have neat tricks to do just that."><meta property=og:image content=https://minimaxir.com/2018/07/imdb-data-analysis/featured.png><meta property=twitter:image content=https://minimaxir.com/2018/07/imdb-data-analysis/featured.png><meta property=og:locale content=en-us><meta property=article:published_time content=2018-07-16T09:45:00&#43;00:00><meta property=article:modified_time content=2018-07-16T09:45:00&#43;00:00><title>Analyzing IMDb Data The Intended Way, with R and ggplot2 | Max Woolf&#39;s Blog</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents><aside class=search-results id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class=col-6><h1>Search</h1></div><div class="col-6 col-search-close"><a class=js-search href=#><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box></div></section><section class=section-search-results><div id=search-hits></div></section></div></aside><nav class="navbar navbar-light fixed-top navbar-expand-lg py-0 compensate-for-scrollbar" id=navbar-main><div class=container><a class=navbar-brand href=/>Max Woolf&#39;s Blog</a>
<button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar aria-controls=navbar aria-expanded=false aria-label="Toggle navigation">
<span><i class="fas fa-bars"></i></span></button><div class="collapse navbar-collapse" id=navbar><ul class="navbar-nav mr-auto"><li class=nav-item><a class=nav-link href=/about/><span>About</span></a></li><li class=nav-item><a class=nav-link href=/post/><span>Posts</span></a></li><li class=nav-item><a class=nav-link href=/portfolio/><span>Portfolio</span></a></li></ul><ul class="navbar-nav ml-auto"><li class=nav-item><a class=nav-link href=https://www.patreon.com/minimaxir target=_blank rel=noopener><span><i class="fab fa-patreon mr-1"></i>Patreon</span></a></li><li class=nav-item><a class=nav-link href=https://github.com/minimaxir target=_blank rel=noopener><span><i class="fab fa-github-alt mr-1"></i>GitHub</span></a></li><li class=nav-item><a class="nav-link js-dark-toggle" href=#><i class="fas fa-moon" aria-hidden=true></i></a></li></ul></div></div></nav><article class=article itemscope itemtype=http://schema.org/Article><div class="article-container pt-3"><h1 itemprop=name>Analyzing IMDb Data The Intended Way, with R and ggplot2</h1><meta content="2018-07-16 09:45:00 &#43;0000 UTC" itemprop=datePublished><meta content="2018-07-16 09:45:00 &#43;0000 UTC" itemprop=dateModified><div class=article-metadata><span class=article-date><time>July 16, 2018</time></span>
<span class=middot-divider></span><span class=article-reading-time>11 min read</span>
<span class=middot-divider></span><span class=article-categories><i class="fas fa-folder mr-1"></i><a href=/categories/data-visualization/>Data Visualization</a>, <a href=/categories/data-science/>Data Science</a>, <a href=/categories/big-data/>Big Data</a></span><div class=share-box aria-hidden=true><ul class=share><li><a href="https://twitter.com/intent/tweet?url=https://minimaxir.com/2018/07/imdb-data-analysis/&amp;text=Analyzing%20IMDb%20Data%20The%20Intended%20Way,%20with%20R%20and%20ggplot2" target=_blank rel=noopener class=share-btn-twitter><i class="fab fa-twitter"></i></a></li><li><a href="https://www.facebook.com/sharer.php?u=https://minimaxir.com/2018/07/imdb-data-analysis/&amp;t=Analyzing%20IMDb%20Data%20The%20Intended%20Way,%20with%20R%20and%20ggplot2" target=_blank rel=noopener class=share-btn-facebook><i class="fab fa-facebook-f"></i></a></li><li><a href="mailto:?subject=Analyzing%20IMDb%20Data%20The%20Intended%20Way,%20with%20R%20and%20ggplot2&amp;body=https://minimaxir.com/2018/07/imdb-data-analysis/" target=_blank rel=noopener class=share-btn-email><i class="fas fa-envelope"></i></a></li><li><a href="https://www.linkedin.com/shareArticle?url=https://minimaxir.com/2018/07/imdb-data-analysis/&amp;title=Analyzing%20IMDb%20Data%20The%20Intended%20Way,%20with%20R%20and%20ggplot2" target=_blank rel=noopener class=share-btn-linkedin><i class="fab fa-linkedin-in"></i></a></li><li><a href="https://reddit.com/submit?url=https://minimaxir.com/2018/07/imdb-data-analysis/&amp;title=Analyzing%20IMDb%20Data%20The%20Intended%20Way,%20with%20R%20and%20ggplot2" target=_blank rel=noopener class=share-btn-reddit><i class="fab fa-reddit-alien"></i></a></li></ul></div></div></div><div class=article-container><div class=article-style itemprop=articleBody><p><a href=https://www.imdb.com target=_blank>IMDb</a>, the Internet Movie Database, has been a popular source for data analysis and visualizations over the years. The combination of user ratings for movies and detailed movie metadata have always been fun to <a href=http://minimaxir.com/2016/01/movie-revenue-ratings/ target=_blank>play with</a>.</p><p><img src=/img/movie-revenue-ratings/box-office-rating-5.png alt></p><p>There are a number of tools to help get IMDb data, such as <a href=https://github.com/alberanid/imdbpy target=_blank>IMDbPY</a>, which makes it easy to programmatically scrape IMDb by pretending it&rsquo;s a website user and extracting the relevant data from the page&rsquo;s HTML output. While it <em>works</em>, web scraping public data is a gray area in terms of legality; many large websites have a Terms of Service which forbids scraping, and can potentially send a DMCA take-down notice to websites redistributing scraped data.</p><p>IMDb has <a href=https://help.imdb.com/article/imdb/general-information/can-i-use-imdb-data-in-my-software/G5JTRESSHJBBHTGX# target=_blank>data licensing terms</a> which forbid scraping and require an attribution in the form of a <strong>Information courtesy of IMDb (<a href=http://www.imdb.com target=_blank>http://www.imdb.com</a>). Used with permission.</strong> statement, and has also <a href=https://www.kaggle.com/tmdb/tmdb-movie-metadata/home target=_blank>DMCAed a Kaggle IMDb dataset</a> to hone the point.</p><p>However, there is good news! IMDb publishes an <a href=https://www.imdb.com/interfaces/ target=_blank>official dataset</a> for casual data analysis! And it&rsquo;s now very accessible, just choose a dataset and download (now with no hoops to jump through), and the files are in the standard <a href=https://en.wikipedia.org/wiki/Tab-separated_values target=_blank>TSV format</a>.</p><p><img src=/img/imdb-data-analysis/datasets.png alt></p><p>The uncompressed files are pretty large; not &ldquo;big data&rdquo; large (it fits into computer memory), but Excel will explode if you try to open them in it. You have to play with the data <em>smartly</em>, and both <a href=https://www.r-project.org target=_blank>R</a> and <a href=https://ggplot2.tidyverse.org/reference/index.html target=_blank>ggplot2</a> have neat tricks to do just that.</p><h2 id=first-steps>First Steps</h2><p>R is a popular programming language for statistical analysis. One of the most popular series of external packages is the <code>tidyverse</code> package, which automatically imports the <code>ggplot2</code> data visualization library and other useful packages which we&rsquo;ll get to one-by-one. We&rsquo;ll also use <code>scales</code> which we&rsquo;ll use later for prettier number formatting. First we&rsquo;ll load these packages:</p><pre><code class=language-r>library(tidyverse)
library(scales)
</code></pre><p>And now we can load a TSV downloaded from IMDb using the <code>read_tsv</code> function from <code>readr</code> (a tidyverse package), which does what the name implies, at a much faster speed than base R (+ a couple other parameters to handle data encoding). Let&rsquo;s start with the <code>ratings</code> file:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r>df_ratings <span style=color:#f92672>&lt;-</span> read_tsv(<span style=color:#e6db74>&#39;title.ratings.tsv&#39;</span>, na <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;\\N&#34;</span>, quote <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>)</code></pre></div><p>We can preview what&rsquo;s in the loaded data using <code>dplyr</code> (a tidyverse package), which is what we&rsquo;ll be using to manipulate data for this analysis. dplyr allows you to pipe commands, making it easy to create a sequence of manipulation commands. For now, we&rsquo;ll use <code>head()</code>, which displays the top few rows of the data frame.</p><pre><code class=language-r>df_ratings %&gt;% head()
</code></pre><p><img src=/img/imdb-data-analysis/ratings.png alt></p><p>Each of the <strong>873k rows</strong> corresponds to a single movie, an ID for the movie, its average rating (from 1 to 10), and the number of votes which contribute to that average. Since we have two numeric variables, why not test out ggplot2 by creating a scatterplot mapping them? ggplot2 takes in a data frame and names of columns as aesthetics, then you specify what type of shape to plot (a &ldquo;geom&rdquo;). Passing the plot to <code>ggsave</code> saves it as a standalone, high-quality data visualization.</p><pre><code class=language-r>plot &lt;- ggplot(df_ratings, aes(x = numVotes, y = averageRating)) +
          geom_point()

ggsave(&quot;imdb-0.png&quot;, plot, width = 4, height = 3)
</code></pre><p><img src=/img/imdb-data-analysis/imdb-0.png alt></p><p>Here is nearly <em>1 million</em> points on a single chart; definitely don&rsquo;t try to do that in Excel! However, it&rsquo;s not a <em>useful</em> chart since all the points are opaque and we&rsquo;re not sure what the spatial density of points is. One approach to fix this issue is to create a heat map of points, which ggplot can do natively with <code>geom_bin2d</code>. We can color the heat map with the <a href=https://cran.r-project.org/web/packages/viridis/vignettes/intro-to-viridis.html target=_blank>viridis</a> colorblind-friendly palettes <a href=https://ggplot2.tidyverse.org/reference/scale_viridis.html target=_blank>just introduced</a> into ggplot2. We should also tweak the axes; the x-axis should be scaled logarithmically with <code>scale_x_log10</code> since there are many movies with high numbers of votes and we can format those numbers with the <code>comma</code> function from the <code>scales</code> package (we can format the scale with <code>comma</code> too). For the y-axis, we can add explicit number breaks for each rating; R can do this neatly by setting the breaks to <code>1:10</code>. Putting it all together:</p><pre><code class=language-r>plot &lt;- ggplot(df_ratings, aes(x = numVotes, y = averageRating)) +
          geom_bin2d() +
          scale_x_log10(labels = comma) +
          scale_y_continuous(breaks = 1:10) +
          scale_fill_viridis_c(labels = comma)
</code></pre><p><img src=/img/imdb-data-analysis/imdb-1.png alt></p><p>Not bad, although it unfortunately confirms that IMDb follows a <a href=https://tvtropes.org/pmwiki/pmwiki.php/Main/FourPointScale target=_blank>Four Point Scale</a> where average ratings tend to fall between 6 — 9.</p><h2 id=mapping-movies-to-ratings>Mapping Movies to Ratings</h2><p>You may be asking &ldquo;which ratings correspond to which movies?&rdquo; That&rsquo;s what the <code>tconst</code> field is for. But first, let&rsquo;s load the title data from <code>title.basics.tsv</code> into <code>df_basics</code> and take a look as before.</p><pre><code class=language-r>df_basics &lt;- read_tsv('title.basics.tsv', na = &quot;\\N&quot;, quote = '')
</code></pre><p><img src=/img/imdb-data-analysis/basics1.png alt>
<img src=/img/imdb-data-analysis/basics2.png alt></p><p>We have some neat movie metadata. Notably, this table has a <code>tconst</code> field as well. Therefore, we can <em>join</em> the two tables together, adding the movie information to the corresponding row in the rating table (in this case, a left join is more appropriate than an inner/full join)</p><pre><code class=language-r>df_ratings &lt;- df_ratings %&gt;% left_join(df_basics)
</code></pre><p>Runtime minutes sounds interesting. Could there be a relationship between the length of a movie and its average rating on IMDb? Let&rsquo;s make a heat map plot again, but with a few tweaks. With the new metadata, we can <code>filter</code> the table to remove bad points; let&rsquo;s keep movies only (as IMDb data also contains <em>television show data</em>), with a runtime &lt; 3 hours, and which have received atleast 10 votes by users to remove extraneous movies). X-axis should be tweaked to display the minutes-values in hours. The fill viridis palette can be changed to another one in the family (I personally like <code>inferno</code>).</p><p>More importantly, let&rsquo;s discuss plot theming. If you want a minimalistic theme, add a <code>theme_minimal</code> to the plot, and you can pass a <code>base_family</code> to change the default font on the plot and a <code>base_size</code> to change the font size. The <code>labs</code> function lets you add labels to the plot (which you should <em>always</em> do); you have your <code>title</code>, <code>x</code>, and <code>y</code> parameters, but you can also add a <code>subtitle</code>, a <code>caption</code> for attribution, and a <code>color</code>/<code>fill</code> to name the scale. Putting it all together:</p><pre><code class=language-r>plot &lt;- ggplot(df_ratings %&gt;% filter(runtimeMinutes &lt; 180, titleType == &quot;movie&quot;, numVotes &gt;= 10), aes(x = runtimeMinutes, y = averageRating)) +
          geom_bin2d() +
          scale_x_continuous(breaks = seq(0, 180, 60), labels = 0:3) +
          scale_y_continuous(breaks = 0:10) +
          scale_fill_viridis_c(option = &quot;inferno&quot;, labels = comma) +
          theme_minimal(base_family = &quot;Source Sans Pro&quot;, base_size = 8) +
          labs(title = &quot;Relationship between Movie Runtime and Average Mobie Rating&quot;,
               subtitle = &quot;Data from IMDb retrieved July 4th, 2018&quot;,
               x = &quot;Runtime (Hours)&quot;,
               y = &quot;Average User Rating&quot;,
               caption = &quot;Max Woolf — minimaxir.com&quot;,
               fill = &quot;# Movies&quot;)
</code></pre><p><img src=/img/imdb-data-analysis/imdb-2b.png alt></p><p>Now that&rsquo;s pretty nice-looking for only a few lines of code! Albeit unhelpful, as there doesn&rsquo;t appear to be a correlation.</p><p><em>(Note: for the rest of this post, the theming/labels code will be omitted for convenience)</em></p><p>How about movie ratings vs. the year the movie was made? It&rsquo;s a similar plot code-wise to the one above (one perk about <code>ggplot2</code> is that there&rsquo;s no shame in reusing chart code!), but we can add a <code>geom_smooth</code>, which adds a nonparametric trendline with confidence bands for the trend; since we have a large amount of data, the bands are very tight. We can also fix the problem of &ldquo;empty&rdquo; bins by setting the color fill scale to logarithmic scaling. And since we&rsquo;re adding a black trendline, let&rsquo;s change the viridis palette to <code>plasma</code> for better contrast.</p><pre><code class=language-r>plot &lt;- ggplot(df_ratings %&gt;% filter(titleType == &quot;movie&quot;, numVotes &gt;= 10), aes(x = startYear, y = averageRating)) +
          geom_bin2d() +
          geom_smooth(color=&quot;black&quot;) +
          scale_x_continuous() +
          scale_y_continuous(breaks = 1:10) +
          scale_fill_viridis_c(option = &quot;plasma&quot;, labels = comma, trans = 'log10')
</code></pre><p><img src=/img/imdb-data-analysis/imdb-4.png alt></p><p>Unfortunately, this trend hasn&rsquo;t changed much either, although the presence of average ratings outside the Four Point Scale has increased over time.</p><h2 id=mapping-lead-actors-to-movies>Mapping Lead Actors to Movies</h2><p>Now that we have a handle on working with the IMDb data, let&rsquo;s try playing with the larger datasets. Since they take up a lot of computer memory, we only want to persist data we actually might use. After looking at the schema provided with the official datasets, the only really useful metadata about the actors is their birth year, so let&rsquo;s load that, but only keep both actors/actresses (using the fast <code>str_detect</code> function from <code>stringr</code>, another tidyverse package) and the relevant fields.</p><pre><code class=language-r>df_actors &lt;- read_tsv('name.basics.tsv', na = &quot;\\N&quot;, quote = '') %&gt;%
                filter(str_detect(primaryProfession, &quot;actor|actress&quot;))  %&gt;%
                select(nconst, primaryName, birthYear)
</code></pre><p><img src=/img/imdb-data-analysis/actor.png alt></p><p>The principals dataset, the large 1.28GB TSV, is the most interesting. It&rsquo;s an unnested list of the credited persons in each movie, with an <code>ordering</code> indicating their rank (where <code>1</code> means first, <code>2</code> means second, etc.).</p><p><img src=/img/imdb-data-analysis/principals.png alt></p><p>For this analysis, let&rsquo;s only look at the <strong>lead actors/actresses</strong>; specifically, for each movie (identified by the <code>tconst</code> value), filter the dataset to where the <code>ordering</code> value is the lowest (in this case, the person at rank <code>1</code> may not necessarily be an actor/actress).</p><pre><code class=language-r>df_principals &lt;- read_tsv('title.principals.tsv', na = &quot;\\N&quot;, quote = '') %&gt;%
  filter(str_detect(category, &quot;actor|actress&quot;)) %&gt;%
  select(tconst, ordering, nconst, category) %&gt;%
  group_by(tconst) %&gt;%
  filter(ordering == min(ordering))
</code></pre><p>Both datasets have a <code>nconst</code> field, so let&rsquo;s join them together. And then join <em>that</em> to the ratings table earlier via <code>tconst</code>.</p><pre><code class=language-r>df_principals &lt;- df_principals %&gt;% left_join(df_actors)
df_ratings &lt;- df_ratings %&gt;% left_join(df_principals)
</code></pre><p>Now we have a fully denormalized dataset in <code>df_ratings</code>. Since we now have the movie release year and the birth year of the lead actor, we can now infer <em>the age of the lead actor at the movie release</em>. With that goal, filter out the data on the criteria we&rsquo;ve used for earlier data visualizations, plus only keeping rows which have an actor&rsquo;s birth year.</p><pre><code class=language-r>df_ratings_movies &lt;- df_ratings %&gt;%
                        filter(titleType == &quot;movie&quot;, !is.na(birthYear), numVotes &gt;= 10) %&gt;%
                        mutate(age_lead = startYear - birthYear) 
</code></pre><p><img src=/img/imdb-data-analysis/denorm1.png alt>
<img src=/img/imdb-data-analysis/denorm2.png alt></p><h2 id=plotting-ages>Plotting Ages</h2><p>Age discrimination in movie casting has been a recurring issue in Hollywood; in fact, in 2017 <a href=https://www.hollywoodreporter.com/thr-esq/judge-pauses-enforcement-imdb-age-censorship-law-978797 target=_blank>a law was signed</a> to force IMDb to remove an actor&rsquo;s age upon request, which in February 2018 was <a href=https://www.hollywoodreporter.com/thr-esq/californias-imdb-age-censorship-law-declared-unconstitutional-1086540 target=_blank>ruled to be unconstitutional</a>.</p><p>Have the ages of movie leads changed over time? For this example, we&rsquo;ll use a <a href=https://ggplot2.tidyverse.org/reference/geom_ribbon.html target=_blank>ribbon plot</a> to plot the ranges of ages of movie leads. A simple way to do that is, for each year, calculate the 25th <a href=https://en.wikipedia.org/wiki/Percentile target=_blank>percentile</a> of the ages, the 50th percentile (i.e. the median), and the 75th percentile, where the 25th and 75th percentiles are the ribbon bounds and the line represents the median.</p><pre><code class=language-r>df_actor_ages &lt;- df_ratings_movies %&gt;%
                  group_by(startYear) %&gt;%
                  summarize(low_age = quantile(age_lead, 0.25, na.rm=T),
                            med_age = quantile(age_lead, 0.50, na.rm=T),
                            high_age = quantile(age_lead, 0.75, na.rm=T))
</code></pre><p>Plotting it with ggplot2 is surprisingly simple, although you need to use different y aesthetics for the ribbon and the overlapping line.</p><pre><code class=language-r>plot &lt;- ggplot(df_actor_ages %&gt;% filter(startYear &gt;= 1920) , aes(x = startYear)) +
          geom_ribbon(aes(ymin = low_age, ymax = high_age), alpha = 0.2) +
          geom_line(aes(y = med_age))
</code></pre><p><img src=/img/imdb-data-analysis/imdb-8.png alt></p><p>Turns out that in the 2000&rsquo;s, the median age of lead actors started to <em>increase</em>? Both the upper and lower bounds increased too. That doesn&rsquo;t coalesce with the age discrimination complaints.</p><p>Another aspect of these complaints is gender, as female actresses tend to be younger than male actors. Thanks to the magic of ggplot2 and dplyr, separating actors/actresses is relatively simple: add gender (encoded in <code>category</code>) as a grouping variable, add it as a color/fill aesthetic in ggplot, and set colors appropriately (I recommend the <a href=http://colorbrewer2.org/ target=_blank>ColorBrewer</a> qualitative palettes for categorical variables).</p><pre><code class=language-r>df_actor_ages_lead &lt;- df_ratings_movies %&gt;%
                  group_by(startYear, category) %&gt;%
                  summarize(low_age = quantile(age_lead, 0.25, na.rm = T),
                            med_age = quantile(age_lead, 0.50, na.rm = T),
                            high_age = quantile(age_lead, 0.75, na.rm = T))
                  
plot &lt;- ggplot(df_actor_ages_lead %&gt;% filter(startYear &gt;= 1920), aes(x = startYear, fill = category, color = category)) +
          geom_ribbon(aes(ymin = low_age, ymax = high_age), alpha = 0.2) +
          geom_line(aes(y = med_age)) +
          scale_fill_brewer(palette = &quot;Set1&quot;) +
          scale_color_brewer(palette = &quot;Set1&quot;)
</code></pre><p><img src=/img/imdb-data-analysis/imdb-9.png alt></p><p>There&rsquo;s about a 10-year gap between the ages of male and female leads, and the gap doesn&rsquo;t change overtime. But both start to rise at the same time.</p><p>One possible explanation for this behavior is actor reuse: if Hollywood keeps casting the same actor/actresses, by construction the ages of the leads will start to steadily increase. Let&rsquo;s verify that: with our list of movies and their lead actors, for each lead actor, order all their movies by release year, and add a ranking for the #th time that actor has been a lead actor. This is possible through the use of <code>row_number</code> in dplyr, and <a href=https://cran.r-project.org/web/packages/dplyr/vignettes/window-functions.html target=_blank>window functions</a> like <code>row_number</code> are data science&rsquo;s most useful secret.</p><pre><code class=language-r>df_ratings_movies_nth &lt;- df_ratings_movies %&gt;%
                      group_by(nconst) %&gt;%
                      arrange(startYear) %&gt;%
                      mutate(nth_lead = row_number())
</code></pre><p><img src=/img/imdb-data-analysis/row_number.png alt></p><p>One more ribbon plot later (w/ same code as above + custom y-axis breaks):</p><p><img src=/img/imdb-data-analysis/imdb-12.png alt></p><p>Huh. The median and upper-bound #th time has <em>dropped</em> over time? Hollywood has been promoting more newcomers as leads? That&rsquo;s not what I expected!</p><p>More work definitely needs to be done in this area. In the meantime, the official IMDb datasets are a lot more robust than I thought they would be! And I only used a fraction of the datasets; the rest tie into TV shows, which are a bit messier. Hopefully you&rsquo;ve seen a good taste of the power of R and ggplot2 for playing with big-but-not-big data!</p><hr><p><em>You can view the R and ggplot used to create the data visualizations in <a href=http://minimaxir.com/notebooks/imdb-data-analysis/ target=_blank>this R Notebook</a>, which includes many visualizations not used in this post. You can also view the images/code used for this post in <a href=https://github.com/minimaxir/imdb-data-analysis target=_blank>this GitHub repository</a></em>.</p><p><em>You are free to use the data visualizations from this article however you wish, but it would be greatly appreciated if proper attribution is given to this article and/or myself!</em></p><div class="alert alert-note"><div>If you liked this blog post, I have set up a <a href=https://www.patreon.com/minimaxir target=_blank>Patreon</a> to fund my machine learning/deep learning/software/hardware needs for my future crazy yet cool projects, and any monetary contributions to the Patreon are appreciated and will be put to good creative use.</div></div></div><div class=article-tags><a class="badge badge-light" href=/tags/video/>Video</a>
<a class="badge badge-light" href=/tags/r/>R</a>
<a class="badge badge-light" href=/tags/ggplot2/>ggplot2</a></div><div class="media author-card" itemscope itemtype=http://schema.org/Person><img class="portrait mr-3" src="https://s.gravatar.com/avatar/28f09e3deff62333b3f32f19d3971d46?s=200')" itemprop=image alt=Avatar><div class=media-body><h5 class=card-title itemprop=name><a href=https://minimaxir.com/>Max Woolf</a></h5><h6 class=card-subtitle>Data Scientist at BuzzFeed</h6><p class=card-text itemprop=description>Ex-Apple. Carnegie Mellon graduate. Plotter of pretty charts. Former TechCrunch comment troll.</p><ul class=network-icon aria-hidden=true><li><a itemprop=sameAs href=https://twitter.com/minimaxir target=_blank rel=noopener><i class="fab fa-twitter"></i></a></li><li><a itemprop=sameAs href=https://linkedin.com/in/minimaxir target=_blank rel=noopener><i class="fab fa-linkedin"></i></a></li><li><a itemprop=sameAs href=https://youtube.com/minimaxir target=_blank rel=noopener><i class="fab fa-youtube"></i></a></li><li><a itemprop=sameAs href=https://twitch.tv/minimaxir target=_blank rel=noopener><i class="fab fa-twitch"></i></a></li><li><a itemprop=sameAs href=mailto:max@minimaxir.com><i class="fas fa-envelope"></i></a></li></ul></div></div><div class=article-widget><div class=hr-light></div><h3>Related</h3><ul><li><a href=/2018/03/basketball-shots/>Visualizing One Million NCAA Basketball Shots</a></li><li><a href=/2018/02/stack-overflow-questions/>A Visual Overview of Stack Overflow&#39;s Question Tags</a></li><li><a href=/2017/08/ggplot2-web/>How to Make High Quality Data Visualizations for Websites With R and ggplot2</a></li><li><a href=/2017/06/imgur-decline/>The Decline of Imgur on Reddit and the Rise of Reddit&#39;s Native Image Hosting</a></li><li><a href=/2017/06/r-notebooks/>Advantages of Using R Notebooks For Data Analysis Instead of Jupyter Notebooks</a></li></ul></div><div class=article-widget><div class=post-nav><div class=post-nav-item><div class=meta-nav>Next</div><a href=/2018/09/modeling-link-aggregators/ rel=next>Problems with Predicting Post Performance on Reddit and Other Link Aggregators</a></div><div class=post-nav-item><div class=meta-nav>Previous</div><a href=/2018/05/text-neural-networks/ rel=prev>How to Quickly Train a Text-Generating Neural Network for Free</a></div></div></div><section id=comments><div id=disqus_thread></div><script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return;}
var d=document,s=d.createElement('script');s.async=true;s.src='//'+"minimaxir"+'.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></section></div></article><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js integrity="sha256-aYTdUrn6Ow1DDgh5JTc3aDGnnju48y/1c8s1dgkYPQ8=" crossorigin=anonymous></script><script src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/r.min.js></script><script>hljs.initHighlightingOnLoad();</script><script src=/js/academic.min.fa2e27444bc8d51f81714869209e3287.js></script><div class=container><footer class=site-footer><p class=powered-by>Copyright Max Woolf &copy; 2019 &middot;
Powered by the
<a href=https://sourcethemes.com/academic/ target=_blank rel=noopener>Academic theme</a> for
<a href=https://gohugo.io target=_blank rel=noopener>Hugo</a>.
<span class=float-right aria-hidden=true><a href=# id=back_to_top><span class=button_icon><i class="fas fa-chevron-up fa-2x"></i></span></a></span></p></footer></div><div id=modal class="modal fade" role=dialog><div class=modal-dialog><div class=modal-content><div class=modal-header><h5 class=modal-title>Cite</h5><button type=button class=close data-dismiss=modal aria-label=Close>
<span aria-hidden=true>&times;</span></button></div><div class=modal-body><pre><code class="tex hljs"></code></pre></div><div class=modal-footer><a class="btn btn-outline-primary my-1 js-copy-cite" href=# target=_blank><i class="fas fa-copy"></i>Copy</a>
<a class="btn btn-outline-primary my-1 js-download-cite" href=# target=_blank><i class="fas fa-download"></i>Download</a><div id=modal-error></div></div></div></div></div></body></html>