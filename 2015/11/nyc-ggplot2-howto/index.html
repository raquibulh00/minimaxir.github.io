<!DOCTYPE html>
<html lang="en" class="no-js">

  <!-- HEAD -->
<head>
<meta charset="utf-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>How to Visualize New York City Using Taxi Location Data and ggplot2</title>
<meta property="article:author" content="https://www.facebook.com/max.woolf" />
<meta name="description" content="A few months ago, I had posted a visualization of NYC Yellow Taxis using ggplot2, an extremely-popular R package by Hadley Wickham for data visualization. At...">
<link href="/rss.xml" rel="alternate" title="minimaxir | Max Woolf's Blog" type="application/atom+xml">
<link rel="canonical" href="http://minimaxir.com/2015/11/nyc-ggplot2-howto/">

<!-- Mobile Metas -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">


 <meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@minimaxir">
<meta name="twitter:creator" content="@minimaxir">

  <meta name="twitter:title" content="How to Visualize New York City Using Taxi Location Data and ggplot2">


  <meta name="twitter:url" content="http://minimaxir.com/2015/11/nyc-ggplot2-howto/">


  <meta name="twitter:description" content="I had posted a visualization of NYC taxis using ggplot2. Due to popular demand, I've cleaned up the code and have released it open source, with a few improvements.">


  <meta name="twitter:image:src" content="http://minimaxir.com/img/nyc-taxi-6.png">

 
 <meta content="minimaxir | Max Woolf's Blog" property="og:site_name">

  <meta content="How to Visualize New York City Using Taxi Location Data and ggplot2" property="og:title">


  <meta content="article" property="og:type">


  <meta content="I had posted a visualization of NYC taxis using ggplot2. Due to popular demand, I've cleaned up the code and have released it open source, with a few improvements." property="og:description">


  <meta content="http://minimaxir.com/2015/11/nyc-ggplot2-howto/" property="og:url">



  <meta content="http://minimaxir.com/img/nyc-taxi-6.png" property="og:image">


  
  <meta content="Data" property="article:section">
  


  



      <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">

    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="white">
    <meta name="apple-mobile-web-app-title" content="minimaxir">
    <link rel="apple-touch-icon-precomposed" href="apple-touch-icon-precomposed.png">

<link rel="apple-touch-icon" sizes="57x57" href="http://minimaxir.com/favicon/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="http://minimaxir.com/favicon/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="http://minimaxir.com/favicon/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="http://minimaxir.com/favicon/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="http://minimaxir.com/favicon/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="http://minimaxir.com/favicon/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="http://minimaxir.com/favicon/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="http://minimaxir.com/favicon/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="http://minimaxir.com/favicon/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="http://minimaxir.com/favicon/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://minimaxir.com/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="http://minimaxir.com/favicon/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="http://minimaxir.com/favicon/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="http://minimaxir.com/favicon/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">

<!-- BEGIN GLOBAL MANDATORY STYLES -->
  <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,300italic,400,400italic,700' rel='stylesheet' type='text/css'>

<link href="/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
<link href="/css/minimaxir.css" rel="stylesheet" type="text/css"/>
<!-- END GLOBAL MANDATORY STYLES -->

<!-- BEGIN THEME STYLES -->
<link href="/css/global.css" rel="stylesheet" type="text/css"/>
<!-- END THEME STYLES -->

<!-- BEGIN JQUERY -->
<script type="text/javascript" src="/js/jquery.min.js"></script>
<!-- END JQUERY -->



  <script>
   $(document).ready(function() {
 
  // LinkedIn
	$( ".social.linkedin" ).children().each(function(index,value) {
	var linkedin_button = $(this);
	var url = linkedin_button.attr("data");

  jQuery.getJSON("http://www.linkedin.com/countserv/count/share?url="+url+"&format=jsonp&callback=?", function(data) {
  linkedin_button.html("<i class=\"fa fa-linkedin\"></i><span class=\"count hidden-xs\"> " + data.count + "</span>");
  });
  });
  });
  </script>
  
</head>
<!-- END HEAD -->
  <!-- WRAPPER -->
<div class="wrapper">
    <!--========== HEADER TRANSPARENT ==========-->
    <header class="header-transparent header-transparent-bb navbar-fixed-top header-sticky">
        <!-- Navbar -->
        <nav class="navbar mega-menu" role="navigation">
            <div class="container">
                <!-- Brand and toggle get grouped for better mobile display -->
                <div class="menu-container">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="toggle-icon"></span>
                    </button>

                    <!-- Navbar Actions -->
                    <div class="navbar-actions">

                    </div>
                    <!-- End Navbar Actions -->

                    <!-- Logo -->
                    <div class="navbar-logo">
                        <a class="navbar-logo-wrap" href="/">
                            <img class="navbar-logo-img navbar-logo-img-white" src="/minimaxir-light.png" alt="minimaxir">
                            <img class="navbar-logo-img navbar-logo-img-dark" src="/minimaxir-dark.png" alt="minimaxir">
                        </a>
                    </div>
                    <!-- End Logo -->
                </div>

                <!-- Collect the nav links, forms, and other content for toggling -->
                <div class="collapse navbar-collapse nav-collapse">
                    <div class="menu-container">
                        <ul class="nav navbar-nav">

                            <li class="nav-item">
                                <a class="nav-item-child" href="/about">
                                    About
                                </a>
                            </li>

                            <li class="nav-item">
                                <a class="nav-item-child" href="/portfolio">
                                    Code Portfolio
                                </a>


                            </li>
                            <li class="nav-item">
                                <a class="nav-item-child" href="/data-portfolio">
                                    Data Portfolio
                                </a>


                            </li>
                             <li class="nav-item">
                                <a class="nav-item-child" href="https://www.patreon.com/minimaxir" target="_blank">
                                    Patreon
                                </a>


                            </li>

                        </ul>
                    </div>
                </div>
                <!-- End Navbar Collapse -->
            </div>
            <!--// End Container-->
        </nav>
        <!-- Navbar -->
    </header>
    <!--========== END HEADER TRANSPARENT ==========-->

        <!--========== BREADCRUMBS V5 ==========-->
    
    
	
	
    
    
    
    <section class="breadcrumbs-v5" style="background: url('/img/nyc-taxi-6.png') no-repeat center center; background-size: cover;">
    
        <div class="container">
            <h1 class="breadcrumbs-v5-title">How to Visualize New York City Using Taxi Location Data and ggplot2</h1>
            <span class="breadcrumbs-v5-subtitle">November 16, 2015
            
    
              <span class="sharing index" style="float: right">
  
		  <span class="social facebook"><a href="https://www.facebook.com/share.php?u=http://minimaxir.com/2015/11/nyc-ggplot2-howto/"  onclick="javascript:window.open(this.href,
  '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=350,width=600');return false;" data="http://minimaxir.com/2015/11/nyc-ggplot2-howto/"><i class="fa fa-facebook"></i><span class="count hidden-xs"></span></a></span>
  
		<span class="social twitter"><a href="http://twitter.com/home/?status=How to Visualize New York City Using Taxi Location Data and ggplot2 - http://minimaxir.com/2015/11/nyc-ggplot2-howto/ - via @minimaxir"  onclick="javascript:window.open(this.href,
  '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=350,width=600');return false;" data=http://minimaxir.com/2015/11/nyc-ggplot2-howto/><i class="fa fa-twitter"></i><span class="count hidden-xs"></span></a> </span>

  <span  class="social linkedin"><a href="http://www.linkedin.com/shareArticle?mini=true&title=&url=http://minimaxir.com/2015/11/nyc-ggplot2-howto/"  onclick="javascript:window.open(this.href,
  '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=450,width=600');return false;" data=http://minimaxir.com/2015/11/nyc-ggplot2-howto/><i class="fa fa-linkedin"></i><span class="count hidden-xs"> -</span></a> </span>
   
			</span>
            
            </span>
        </div>
    </section>
    
    
    <!--========== END BREADCRUMBS V5 ==========-->
  
  <!-- BEGIN BODY -->
<body>

  
      <!--========== BACKGROUND COLOR SKY LIGHT ==========-->
    <div class="bg-color-sky-light">

        
        <!--========== PAGE CONTENT ==========-->
        <div class="content-sm container">
        
            
		
        
            <div class="row">
                <div class="col-md-9 md-margin-b-50">
                    <!-- Blog Grid -->
                    <article class="blog-grid margin-b-30">
                        <!-- Image -->
                        <!--<img class="img-responsive" src="/assets/img/1920x1080/20.jpg" alt="">-->
                        <!-- End Image -->

                        <!-- Blog Grid Content -->
						<div class="blog-grid-content">
						<p>A few months ago, I had <a href="http://minimaxir.com/2015/08/nyc-map/">posted a visualization</a> of NYC Yellow Taxis using <a href="http://ggplot2.org">ggplot2</a>, an extremely-popular R package by Hadley Wickham for data visualization. At the time, the code used for the chart was very messy since I was eager to create something cool after seeing the <a href="https://news.ycombinator.com/item?id=10003118">referenced Hacker News thread</a>. Due to popular demand, I&rsquo;ve cleaned up the code and have <a href="https://github.com/minimaxir/nyc-taxi-notebook">released it open source</a>, with a few improvements.</p>

<p>Here are some tips and tutorials on how to make such visualizations.</p>

<h2>Getting the Data</h2>

<p><em>As usual, a <a href="https://github.com/minimaxir/nyc-taxi-notebook/blob/master/nyc_taxi_map.ipynb">Jupyter notebook</a> containing the code and visualizations used in this article is available open-source on GitHub.</em></p>

<p>A quick summary of the previous post: I obtained the data from <a href="https://cloud.google.com/bigquery/">BigQuery</a>, which <a href="http://www.nyc.gov/html/tlc/html/about/trip_record_data.shtml">was uploaded</a> from the official NYC Taxi &amp; Limousine Commission datasets, plotted each taxi point as a tiny white dot on a fully-black map, and colorized the dots depending on the number of taxis at that location.</p>

<p>In September, the <a href="https://bigquery.cloud.google.com/table/nyc-tlc:yellow.trips">BigQuery dataset</a> was updated to include all data from January 2009 to June 2015: over 1.1 <em>billion</em> Yellow Taxi rides recorded. Here&rsquo;s an updated query, which additionally calculates the total non-tip revenue for a given location, since that might be useful later, and implements a <a href="https://www.reddit.com/r/bigquery/comments/3fo9ao/nyc_taxi_trips_now_officially_shared_by_the_nyc/ctqfr8h">sanity check filter</a> noted by Felipe Hoffa.</p>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">SELECT</span> <span class="n">ROUND</span><span class="p">(</span><span class="n">pickup_latitude</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="k">AS</span> <span class="n">lat</span><span class="p">,</span>
<span class="n">ROUND</span><span class="p">(</span><span class="n">pickup_longitude</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="k">AS</span> <span class="n">long</span><span class="p">,</span>
<span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">AS</span> <span class="n">num_pickups</span><span class="p">,</span>
<span class="k">SUM</span><span class="p">(</span><span class="n">fare_amount</span><span class="p">)</span> <span class="k">AS</span> <span class="n">total_revenue</span>
<span class="k">FROM</span> <span class="p">[</span><span class="n">nyc</span><span class="o">-</span><span class="n">tlc</span><span class="p">:</span><span class="n">yellow</span><span class="p">.</span><span class="n">trips</span><span class="p">]</span>
<span class="k">WHERE</span> <span class="n">fare_amount</span><span class="o">/</span><span class="n">trip_distance</span> <span class="k">BETWEEN</span> <span class="mi">2</span> <span class="k">AND</span> <span class="mi">10</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">lat</span><span class="p">,</span> <span class="n">long</span></code></pre></figure>

<p>The resulting dataset is 4 million rows and 116MB in size! This is well over the limit for downloading from the web BigQuery client, so you must use a local client (in the attached notebook, R), and it will still take about 10-15 minutes to download (as a result, I recommend caching the results locally). Relatedly, rendering 4 million points on a single plot on screen may be computationally intensive: I strongly recommend rendering the visualization to disk by instantiating a <code>png</code> device or by using <code>ggsave</code>.</p>

<p>Here&rsquo;s a few results from that query.</p>

<p><img src="/img/nyc-ggplot2-howto/test-data.png" alt=""></p>

<p>As you can see, the second latitude/longitude combo is blatantly <em>wrong</em>. This isn&rsquo;t the first fidelity issue with the dataset, but we will address those in due time.</p>

<h2>Plotting the Taxis</h2>

<p>Let&rsquo;s do a basic ggplot2 plot to test things out. All we need to do is plot a small point for every lat/long combination, and then save the resulting plot.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">plot</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ggplot</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">long</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">lat</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
            </span><span class="n">geom_point</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">0.06</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">

</span><span class="n">png</span><span class="p">(</span><span class="s2">"nyc-taxi-1.png"</span><span class="p">,</span><span class="w"> </span><span class="n">w</span><span class="o">=</span><span class="m">600</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="o">=</span><span class="m">600</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="w">
</span><span class="n">dev.off</span><span class="p">()</span></code></pre></figure>

<p><img src="/img/nyc-ggplot2-howto/nyc-taxi-1.png" alt=""></p>

<p>&hellip;stupid data fidelity issues.</p>

<p>This issue is fixed by constraining the plot to a <a href="https://en.wikipedia.org/wiki/Minimum_bounding_box">bounding box</a> of latitude and longitude coordinates corresponding to NYC. Flickr has <a href="https://www.flickr.com/places/info/2459115">a good starting point</a> for a NYC bounding box; I took that and edited the limits more precisely using the <a href="http://boundingbox.klokantech.com">Bounding Box Tool</a>.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">min_lat</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">40.5774</span><span class="w">
</span><span class="n">max_lat</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">40.9176</span><span class="w">
</span><span class="n">min_long</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">-74.15</span><span class="w">
</span><span class="n">max_long</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">-73.7004</span></code></pre></figure>

<p>You could also enforce the bounding box during the BigQuery. Now let&rsquo;s implement the bounding box in the plot:</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">plot</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ggplot</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">long</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">lat</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
            </span><span class="n">geom_point</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">0.06</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
            </span><span class="n">scale_x_continuous</span><span class="p">(</span><span class="n">limits</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">min_long</span><span class="p">,</span><span class="w"> </span><span class="n">max_long</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
            </span><span class="n">scale_y_continuous</span><span class="p">(</span><span class="n">limits</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">min_lat</span><span class="p">,</span><span class="w"> </span><span class="n">max_lat</span><span class="p">))</span><span class="w">

</span><span class="n">png</span><span class="p">(</span><span class="s2">"nyc-taxi-2.png"</span><span class="p">,</span><span class="w"> </span><span class="n">w</span><span class="o">=</span><span class="m">600</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="o">=</span><span class="m">600</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="w">
</span><span class="n">dev.off</span><span class="p">()</span></code></pre></figure>

<p><img src="/img/nyc-ggplot2-howto/nyc-taxi-2.png" alt=""></p>

<p>Much, much better! Now that the visualization generally looks like what we want it to be, we can start theming.</p>

<p>Let&rsquo;s start small and do just a few tweaks:</p>

<ul>
<li>Filter the data slightly to reduce some erroneous points.</li>
<li>The theme must be primarily a black background, with most of the ggplot2 theme attributes stripped out and the margins nullified. (implemented as <code>theme_map_dark()</code>; code is in the notebook)</li>
<li>Set the resolution of the rendering device to 300 DPI; this reduces some of the aliasing in the resulting image.</li>
</ul>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">plot</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ggplot</span><span class="p">(</span><span class="n">df</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">filter</span><span class="p">(</span><span class="n">num_pickups</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">10</span><span class="p">),</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">long</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">lat</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
            </span><span class="n">geom_point</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">"white"</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">0.06</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
            </span><span class="n">scale_x_continuous</span><span class="p">(</span><span class="n">limits</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">min_long</span><span class="p">,</span><span class="w"> </span><span class="n">max_long</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
            </span><span class="n">scale_y_continuous</span><span class="p">(</span><span class="n">limits</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">min_lat</span><span class="p">,</span><span class="w"> </span><span class="n">max_lat</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
            </span><span class="n">theme_map_dark</span><span class="p">()</span><span class="w">

</span><span class="n">png</span><span class="p">(</span><span class="s2">"nyc-taxi-3.png"</span><span class="p">,</span><span class="w"> </span><span class="n">w</span><span class="o">=</span><span class="m">600</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="o">=</span><span class="m">600</span><span class="p">,</span><span class="w"> </span><span class="n">res</span><span class="o">=</span><span class="m">300</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="w">
</span><span class="n">dev.off</span><span class="p">()</span></code></pre></figure>

<p><img src="/img/nyc-ggplot2-howto/nyc-taxi-3.png" alt=""></p>

<p>Right on track! Now time to make things more professional.</p>

<p>This requires the implementation of a few more aesthetics:</p>

<ul>
<li>Add a gradient color based on intensity of the number of pickups: since the number of pickups will logically be near streets, the coloring will be more intense near streets. Exact color doesn&rsquo;t matter; I used the purple Wisteria from <a href="https://flatuicolors.com">Flat UI Colors</a> to represent maximum intensity. Additionally, the scale should be logarithmic to make the colors stand out. (Another approach is to scale the transparency of the points instead, which is the approach <a href="http://www.brianrlance.com/blog/2015/8/7/nyc-visualized-via-taxi-pickup-locations">Brian Lance had done</a> and that works well too)</li>
<li>Annotate the theme with a proper title (and remove the scale legend; since the exact values on specific points will not be helpful)</li>
<li>Force the plot to obey the dimension ratio with <code>coord_equal()</code>, otherwise the map will stretch and distort to fill the entirety of the plotting area. (you can see a vertical stretch effect with the previous image)</li>
</ul>

<p>Putting it all together:</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">plot</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ggplot</span><span class="p">(</span><span class="n">df</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">filter</span><span class="p">(</span><span class="n">num_pickups</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">10</span><span class="p">),</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">long</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">lat</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="n">num_pickups</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
            </span><span class="n">geom_point</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">0.06</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
            </span><span class="n">scale_x_continuous</span><span class="p">(</span><span class="n">limits</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">min_long</span><span class="p">,</span><span class="w"> </span><span class="n">max_long</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
            </span><span class="n">scale_y_continuous</span><span class="p">(</span><span class="n">limits</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">min_lat</span><span class="p">,</span><span class="w"> </span><span class="n">max_lat</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
            </span><span class="n">theme_map_dark</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
            </span><span class="n">scale_color_gradient</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="s2">"#CCCCCC"</span><span class="p">,</span><span class="w"> </span><span class="n">high</span><span class="o">=</span><span class="s2">"#8E44AD"</span><span class="p">,</span><span class="w"> </span><span class="n">trans</span><span class="o">=</span><span class="s2">"log"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
            </span><span class="n">labs</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Map of NYC, Plotted Using Locations Of All Yellow Taxi Pickups"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
            </span><span class="n">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="o">=</span><span class="s2">"none"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
            </span><span class="n">coord_equal</span><span class="p">()</span><span class="w">

</span><span class="n">png</span><span class="p">(</span><span class="s2">"nyc-taxi-4.png"</span><span class="p">,</span><span class="w"> </span><span class="n">w</span><span class="o">=</span><span class="m">600</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="o">=</span><span class="m">600</span><span class="p">,</span><span class="w"> </span><span class="n">res</span><span class="o">=</span><span class="m">300</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="w">
</span><span class="n">dev.off</span><span class="p">()</span></code></pre></figure>

<p>results in this image, which is what we want! However there is a slight problem, and I will wrap the image in a red border to demonstrate.</p>

<p><span><style>
.border img {
  border: 3px solid red;
}
</style></span></p>

<p><span class="border"><img src="/img/nyc-ggplot2-howto/nyc-taxi-4.png" alt=""></span></p>

<p>Due to <code>coord_equal()</code> enforcing the chart dimensions, the rendering device has a gap of white space at the top due to interaction with the <code>grid</code> graphics package that ggplot2 is based upon; normally not a problem for default charts, but a waste of space for visualizations with non-white backgrounds.</p>

<p>I attempted to fix this issue by forcing <code>grid</code> to render a black rectangle then plot on top of it. Unfornately, that was not successful. The quickest workaround is to set the image dimensions through trial-and-error such that the issue is minimized.</p>

<p>All things considered, that&rsquo;s minor but should still be noted. The streets of Manhattan are visible! And there&rsquo;s still more that can be done.</p>

<h2>Hexing the Revenue</h2>

<p>Hex map overlays are a popular technique for aggregating two-dimensional data on a 3rd dimension. ggplot2 has a relatively new <a href="http://docs.ggplot2.org/current/stat_summary_hex.html">stat_summary_hex</a> function which does just that.</p>

<p>Why not aggregate total revenue for NYC Yellow Taxi Pickups to determine where taxis generate the most money? Since we conveniently have the code to generate a map of NYC already, we can plot the hex bins on top of that map, after a few more tweaks:</p>

<ul>
<li>Set the 3rd dimension, <code>z</code>, to <code>total_revenue</code></li>
<li>Set the aggregation to the <code>sum</code> function, so it sums up all the revenues within a bin.</li>
<li>Scale the total hex revenues with a gradient.</li>
<li>Tweak all the aesthetics: color of the base points, the color of the hexes, the transparency of the hexes, and the name of the chart.</li>
<li>Set the chart dimensions to avoid the <code>coord_equal()</code> issue mention above.</li>
</ul>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">plot</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ggplot</span><span class="p">(</span><span class="n">df</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">filter</span><span class="p">(</span><span class="n">num_pickups</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">20</span><span class="p">),</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">long</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">lat</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="o">=</span><span class="n">total_revenue</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
            </span><span class="n">geom_point</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">0.06</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s2">"#999999"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
            </span><span class="n">stat_summary_hex</span><span class="p">(</span><span class="n">fun</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sum</span><span class="p">,</span><span class="w"> </span><span class="n">bins</span><span class="o">=</span><span class="m">100</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="o">=</span><span class="m">0.7</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
            </span><span class="n">scale_x_continuous</span><span class="p">(</span><span class="n">limits</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">min_long</span><span class="p">,</span><span class="w"> </span><span class="n">max_long</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
            </span><span class="n">scale_y_continuous</span><span class="p">(</span><span class="n">limits</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">min_lat</span><span class="p">,</span><span class="w"> </span><span class="n">max_lat</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
            </span><span class="n">theme_map_dark</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
            </span><span class="n">scale_fill_gradient</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="s2">"#CCCCCC"</span><span class="p">,</span><span class="w"> </span><span class="n">high</span><span class="o">=</span><span class="s2">"#27AE60"</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="o">=</span><span class="n">dollar</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
            </span><span class="n">labs</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Total Revenue for NYC Yellow Taxis by Pickup Location, from Jan 2009 ― June 2015"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
            </span><span class="n">coord_equal</span><span class="p">()</span><span class="w">

</span><span class="n">png</span><span class="p">(</span><span class="s2">"nyc-taxi-5.png"</span><span class="p">,</span><span class="w"> </span><span class="n">w</span><span class="o">=</span><span class="m">950</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="o">=</span><span class="m">860</span><span class="p">,</span><span class="w"> </span><span class="n">res</span><span class="o">=</span><span class="m">300</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="w">
</span><span class="n">dev.off</span><span class="p">()</span></code></pre></figure>

<p><img src="/img/nyc-ggplot2-howto/nyc-taxi-5.png" alt=""></p>

<p>That wasn&rsquo;t too bad. The gradient shows that <a href="https://www.google.com/maps/place/penn+station+nyc/@40.750568,-73.993519,15z">Penn Station</a> in Manhattan, along with the two airports, are the largest revenue generators.</p>

<p>I <a href="https://www.reddit.com/r/dataisbeautiful/comments/3sjmc0/total_revenue_for_nyc_yellow_taxis_by_pickup/">posted the hex-overlayed map</a> on Reddit to /r/dataisbeautiful as a part of my data visualization beta-testing. Although the chart received just under 200 upvotes, the comments in the Reddit thread were <em>unanimously negative</em>. Reddit user /u/DanHeidel <a href="https://www.reddit.com/r/dataisbeautiful/comments/3sjmc0/total_revenue_for_nyc_yellow_taxis_by_pickup/cwxuy1e">posted a long rant</a> on the problems with the aesthetics of the chart. And for the most part, I agree with his assessment.</p>

<p>Let&rsquo;s try again, and address the claims made in the Reddit comments.</p>

<ul>
<li>Only show hex bins where there is enough valid data, which should remove the mysterious hexes over the water. This can be implemented through a helper aggregate function which does not render the hex if the total revenue of the hex is under some threshold value. (I set it to $100,000)</li>
<li>Scale the total hex revenue logarithmically, and change the color to a Red hue (Alizarin) to make the step values more visible.</li>
<li>Zoom the chart dimensions closer to Manhattan.</li>
<li>Make a few more aesthetic tweaks.</li>
</ul>

<p>Here&rsquo;s take two:</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">total_rev</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">threshold</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="o">^</span><span class="m">5</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nf">sum</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">threshold</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="n">return</span><span class="w"> </span><span class="p">(</span><span class="kc">NA</span><span class="p">)}</span><span class="w">
    </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="n">return</span><span class="w"> </span><span class="p">(</span><span class="nf">sum</span><span class="p">(</span><span class="n">x</span><span class="p">))}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="n">plot</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ggplot</span><span class="p">(</span><span class="n">df</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">filter</span><span class="p">(</span><span class="n">num_pickups</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">10</span><span class="p">),</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">long</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">lat</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="o">=</span><span class="n">total_revenue</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
            </span><span class="n">geom_point</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">0.06</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s2">"#999999"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
            </span><span class="n">stat_summary_hex</span><span class="p">(</span><span class="n">fun</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">total_rev</span><span class="p">,</span><span class="w"> </span><span class="n">bins</span><span class="o">=</span><span class="m">100</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="o">=</span><span class="m">0.5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
            </span><span class="n">scale_x_continuous</span><span class="p">(</span><span class="n">limits</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">-74.0224</span><span class="p">,</span><span class="w"> </span><span class="m">-73.8521</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
            </span><span class="n">scale_y_continuous</span><span class="p">(</span><span class="n">limits</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">40.6959</span><span class="p">,</span><span class="w"> </span><span class="m">40.8348</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
            </span><span class="n">theme_map_dark</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
            </span><span class="n">scale_fill_gradient</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="s2">"#FFFFFF"</span><span class="p">,</span><span class="w"> </span><span class="n">high</span><span class="o">=</span><span class="s2">"#E74C3C"</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="o">=</span><span class="n">dollar</span><span class="p">,</span><span class="w"> </span><span class="n">trans</span><span class="o">=</span><span class="s2">"log"</span><span class="p">,</span><span class="w"> </span><span class="n">breaks</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">10</span><span class="o">^</span><span class="p">(</span><span class="m">6</span><span class="o">:</span><span class="m">8</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w">
            </span><span class="n">labs</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Total Revenue for NYC Yellow Taxis by Pickup Location, from Jan 2009 ― June 2015"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
            </span><span class="n">coord_equal</span><span class="p">()</span><span class="w">

</span><span class="n">png</span><span class="p">(</span><span class="s2">"nyc-taxi-6.png"</span><span class="p">,</span><span class="w"> </span><span class="n">w</span><span class="o">=</span><span class="m">900</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="o">=</span><span class="m">900</span><span class="p">,</span><span class="w"> </span><span class="n">res</span><span class="o">=</span><span class="m">300</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="w">
</span><span class="n">dev.off</span><span class="p">()</span></code></pre></figure>

<p><img src="/img/nyc-ggplot2-howto/nyc-taxi-6.png" alt=""></p>

<p>A good step forward. Revenue all through Manhattan is mostly the same except for Penn Station. Meanwhile, the hexes in LaGuardia Airport are noticeably more saturated than Penn Station.</p>

<p>Hopefully, this tutorial gave you a good look into a few interesting tricks that can be accomplished with ggplot2, even though the code can be somewhat messy. If you want more orthodox methods of plotting geographic data in ggplot2, you should look into the <a href="https://cran.r-project.org/web/packages/ggmap/index.html">ggmap</a> R package, which I used to plot <a href="http://minimaxir.com/2014/04/san-francisco/">Facebook Checkin data in San Francisco</a>, and look into the <a href="https://cran.r-project.org/web/packages/maps/index.html">maps</a> R package plus shape files, which I used to plot <a href="http://minimaxir.com/2015/01/tree-time/">Instagram photo location data</a>. Unfortunately, the code may not necessarily be less messy.</p>

<hr>

<p><em>If you use the code or data visualization designs contained within this article, it would be greatly appreciated if proper attribution is given back to this article and/or myself. Thanks!</em></p>

                        
                        
                        <div class="alert alert-warning" role="alert">

     <p>If you liked this blog post, I have set up a <a href="https://www.patreon.com/minimaxir">Patreon</a> to fund my machine learning/deep learning/software/hardware needs for my future crazy yet cool projects, and any monetary contributions to the Patreon are appreciated and will be put to good creative use.</p>

    
</div>
                        
						
            			 <div class="breadcrumbs-v5-subtitle sharing-post" style="color: #999 !important; padding-top:10px; border-top: 1px solid #eee">Share this article!


              <span class="sharing index" style="float: right; color: #999 !important;">
  
		  <span class="social facebook"><a href="https://www.facebook.com/share.php?u=http://minimaxir.com/2015/11/nyc-ggplot2-howto/"  onclick="javascript:window.open(this.href,
  '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=350,width=600');return false;" data="http://minimaxir.com/2015/11/nyc-ggplot2-howto/"><i class="fa fa-facebook"></i><span class="count hidden-xs"></span></a></span>
  
		<span class="social twitter"><a href="http://twitter.com/home/?status=How to Visualize New York City Using Taxi Location Data and ggplot2 - http://minimaxir.com/2015/11/nyc-ggplot2-howto/ - via @minimaxir"  onclick="javascript:window.open(this.href,
  '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=350,width=600');return false;" data=http://minimaxir.com/2015/11/nyc-ggplot2-howto/><i class="fa fa-twitter"></i><span class="count hidden-xs"></span></a> </span>

  <span  class="social linkedin"><a href="http://www.linkedin.com/shareArticle?mini=true&title=&url=http://minimaxir.com/2015/11/nyc-ggplot2-howto/"  onclick="javascript:window.open(this.href,
  '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=450,width=600');return false;" data=http://minimaxir.com/2015/11/nyc-ggplot2-howto/><i class="fa fa-linkedin"></i><span class="count hidden-xs"> -</span></a> </span>

   </span>
   </div>
						</div>
                        <!-- End Blog Grid Content -->
                        
                        
                        
                    </article>
                    <!-- End Blog Grid -->

 					

                    <!-- Blog Comment -->
                    <div class="blog-comments bg-color-white margin-b-30">
                        <div class="blog-single-post-content">

						

<script type="text/javascript">
      var disqus_shortname = 'minimaxir';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://minimaxir.com/2015/11/nyc-ggplot2-howto/';
        var disqus_url = 'http://minimaxir.com/2015/11/nyc-ggplot2-howto/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>

<div id="disqus_thread"></div>



                        </div>
                    </div>
                    <!-- End Blog Comment -->
                    
                    
                </div>

			<!--========== BLOG SIDEBAR ==========-->
<div class="col-md-3">



    <!-- Blog Author -->
    <div class="blog-sidebar margin-b-30">
        <div class="blog-sidebar-heading">
            <h4 class="blog-sidebar-heading-title">Author</h4>
        </div>

        <img src="/MaxFB.jpg" title="Stop mousing over me! I'm not a XKCD comic!" class="img-responsive hidden-xs hidden-sm"></img>

        <div class="blog-sidebar-content">
            <!-- Blog Author Bio -->
             <p><strong>Max Woolf (@minimaxir)</strong> is an Associate Data Scientist at BuzzFeed in San Francisco. He is also an ex-Apple employee and Carnegie Mellon University graduate.</p>

<p>In his spare time, Max uses <a href="https://www.python.org/">Python</a> to gather data from public APIs and <a href="http://ggplot2.org/">ggplot2</a> to plot plenty of pretty charts from that data. On special occasions, he uses <a href="https://github.com/fchollet/keras">Keras</a> for fancy deep learning projects.</p>

<p>You can learn more about Max <a href="/about">here</a>, view his data analysis portfolio <a href="/data-portfolio">here</a>, or view his coding portfolio <a href="/portfolio">here</a>. </p>


            <ul class="list-inline" style="padding-top:10px; margin-top: 20px; border-top: 1px solid #ebeef6">
                <li class="theme-icons-wrap"><a title="Facebook" href="https://facebook.com/max.woolf" target="_blank"><i class="theme-icons theme-icons-grey-light-bg theme-icons-xs radius-circle fa fa-facebook"></i></a></li>
                <li class="theme-icons-wrap"><a title="Twitter" href="https://twitter.com/minimaxir" target="_blank"><i class="theme-icons theme-icons-grey-light-bg theme-icons-xs radius-circle fa fa-twitter"></i></a></li>
                <li class="theme-icons-wrap"><a title="LinkedIn" href="https://linkedin.com/in/minimaxir" target="_blank"><i class="theme-icons theme-icons-grey-light-bg theme-icons-xs radius-circle fa fa-linkedin"></i></a></li>
                <li class="theme-icons-wrap"><a title="E-Mail" href="mailto:max@minimaxir.com"><i class="theme-icons theme-icons-grey-light-bg theme-icons-xs radius-circle fa fa-envelope"></i></a></li>
                <li class="theme-icons-wrap"><a title="GitHub" href="https://github.com/minimaxir" target="_blank"><i class="theme-icons theme-icons-grey-light-bg theme-icons-xs radius-circle fa fa-github"></i></a></li>
                <li class="theme-icons-wrap"><a title="YouTube" href="https://youtube.com/minimaxir" target="_blank"><i class="theme-icons theme-icons-grey-light-bg theme-icons-xs radius-circle fa fa-youtube"></i></a></li>
                <li class="theme-icons-wrap"><a title="RSS" href="/rss.xml"><i class="theme-icons theme-icons-grey-light-bg theme-icons-xs radius-circle fa fa-rss"></i></a></li>
            </ul>
            <!-- End Blog Author Bio -->
        </div>
    </div>
    <!-- End Blog Author -->

    <!-- Blog Recent Posts -->
    <div class="blog-sidebar margin-b-30">
        <div class="blog-sidebar-heading">
            <h4 class="blog-sidebar-heading-title">Recent Posts</h4>
        </div>
        <div class="blog-sidebar-content" style="position: relative; overflow: visible;">

            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="/2018/03/basketball-shots/">Visualizing One Million NCAA Basketball Shots</a></h5>
                    <small class="latest-tuts-content-time"> Mar 19, 2018</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="/2018/02/stack-overflow-questions/">A Visual Overview of Stack Overflow's Question Tags</a></h5>
                    <small class="latest-tuts-content-time"> Feb 9, 2018</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="/2017/11/benchmark-gpus/">Benchmarking Modern GPUs for Maximum Cloud Cost Efficiency in Deep Learning</a></h5>
                    <small class="latest-tuts-content-time"> Nov 28, 2017</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="/2017/11/magic-the-gifening/">Making Magic: the GIFening</a></h5>
                    <small class="latest-tuts-content-time"> Nov 7, 2017</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="/2017/08/ggplot2-web/">How to Make High Quality Data Visualizations for Websites With R and ggplot2</a></h5>
                    <small class="latest-tuts-content-time"> Aug 14, 2017</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="/2017/07/cpu-or-gpu/">Benchmarking TensorFlow on Cloud CPUs: Cheaper Deep Learning than Cloud GPUs</a></h5>
                    <small class="latest-tuts-content-time"> Jul 5, 2017</small>
                </div>
            </article>
            
        </div>
        <!-- End Blog Recent Posts -->
    </div>

    <!-- GitHub Top Repositories -->
    <div class="blog-sidebar margin-b-30">
        <div class="blog-sidebar-heading">
            <h4 class="blog-sidebar-heading-title">GitHub Code Repositories</h4>
        </div>
        <div class="blog-sidebar-content" style="position: relative; overflow: visible;">

            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="http://github.com/minimaxir/big-list-of-naughty-strings" target="_blank">Big List of Naughty Strings</a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-star"></i> 21,523+</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="http://github.com/minimaxir/facebook-page-post-scraper" target="_blank">Facebook Page Post Scraper</a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-star"></i> 1,436+</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="http://github.com/minimaxir/textgenrnn" target="_blank">textgenrnn</a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-star"></i> 234+</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="http://github.com/minimaxir/reactionrnn" target="_blank">reactionrnn</a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-star"></i> 201+</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="http://github.com/minimaxir/system-dashboard" target="_blank">Multiplatform System Dashboard</a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-star"></i> 100+</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="http://github.com/minimaxir/tritonize" target="_blank">Tritonize</a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-star"></i> 9+</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="http://github.com/minimaxir/stylistic-word-clouds" target="_blank">Stylistic Word Clouds</a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-star"></i> 30+</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="http://github.com/minimaxir/char-embeddings" target="_blank">Pretrained Character Embeddings for Deep Learning and Automatic Text Generation</a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-star"></i> 8+</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="http://github.com/minimaxir/get-profile-data-of-repo-stargazers" target="_blank">Get GitHub Profile Data of All Stargazers of a GitHub Repo</a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-star"></i> 15+</small>
                </div>
            </article>
            
        </div>
    </div>

    <!-- End GitHub Top Repositories -->

    <!-- Data Top Repositories -->
    <div class="blog-sidebar margin-b-30">
        <div class="blog-sidebar-heading">
            <h4 class="blog-sidebar-heading-title">Data Analysis Notebooks</h4>
        </div>
        <div class="blog-sidebar-content" style="position: relative; overflow: visible;">

            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="http://minimaxir.com/notebooks/imgur-decline/" target="_blank">The Decline of Imgur on Reddit and the Rise of Reddit's Native Image Hosting</a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-cogs"></i> R, ggplot2</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="http://minimaxir.com/notebooks/keras-cntk/" target="_blank">Benchmarking CNTK on Keras: is it Better at Deep Learning than TensorFlow?</a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-cogs"></i> R, ggplot2</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="http://minimaxir.com/notebooks/char-tsne/" target="_blank">Pretrained Character Embeddings for Deep Learning and Automatic Text Generation</a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-cogs"></i> R, ggplot2</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="http://minimaxir.com/notebooks/predicting-arrests/" target="_blank">Predicting And Mapping Arrest Types in San Francisco</a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-cogs"></i> R, ggplot2, LightGBM</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="http://minimaxir.com/notebooks/amazon-spark/" target="_blank">Playing with 80 Million Amazon Product Review Ratings</a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-cogs"></i> R, ggplot2, Spark</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="http://minimaxir.com/notebooks/interactive-network/" target="_blank">How to Create an Interactive WebGL Network Graph</a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-cogs"></i> R, ggplot2, plotly</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="http://minimaxir.com/notebooks/first-comment/" target="_blank">What Percent of the Top-Voted Comments in Reddit Threads Were Also 1st Comment?</a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-cogs"></i> R, ggplot2</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="https://github.com/minimaxir/clickbait-cluster/blob/master/fb_news_53D_spark.ipynb" target="_blank">Processing Clusters of Clickbait Headlines </a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-cogs"></i> Python, Spark, word2vec</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="https://github.com/minimaxir/clickbait-cluster/blob/master/fb_news_53D_plotly.ipynb" target="_blank">Visualizing Clusters of Clickbait Headlines </a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-cogs"></i> R, plotly</small>
                </div>
            </article>
            
        </div>
    </div>

    <!-- End GitHub Top Repositories -->



</div>
<!--========== END BLOG SIDEBAR ==========-->
			</div>
            <!--// end row -->
        </div>
        <!--========== END PAGE CONTENT ==========-->

    </div>
    <!--========== END BACKGROUND COLOR SKY LIGHT ==========-->
    



  
              <div class="wrapper">
    
	
	
    	 <section class="breadcrumbs-v5 bg-position-fixed" style="background: #2c3e50;  padding: 20px 0 20px !important;">
        <div class="container">
            <div class="row hero-index">
            <div class="col-sm-6 sm-margin-b-30 hidden-xs">
                <img src="/MaxFBInvert.png" title="Stop mousing over me! I'm not a XKCD comic!" class="img-responsive" style="border-radius: 30px; margin: 0 auto; max-height: 400px"></img>
            </div>
            <div class="col-sm-6 col-xs-12">

			
			<p><strong>Max Woolf (@minimaxir)</strong> is an Associate Data Scientist at BuzzFeed in San Francisco. He is also an ex-Apple employee and Carnegie Mellon University graduate.</p>

<p>In his spare time, Max uses <a href="https://www.python.org/">Python</a> to gather data from public APIs and <a href="http://ggplot2.org/">ggplot2</a> to plot plenty of pretty charts from that data. On special occasions, he uses <a href="https://github.com/fchollet/keras">Keras</a> for fancy deep learning projects.</p>

<p>You can learn more about Max <a href="/about">here</a>, view his data analysis portfolio <a href="/data-portfolio">here</a>, or view his coding portfolio <a href="/portfolio">here</a>. </p>

  
  
  <ul class="list-inline" style="padding-top:20px; margin-top: 40px; border-top: 1px solid white;">
                        <li class="theme-icons-wrap"><a title="Facebook" href="https://facebook.com/max.woolf" target="_blank"><i class="theme-icons theme-icons-white-brd theme-icons-md radius-circle fa fa-facebook"></i></a></li>
                        <li class="theme-icons-wrap"><a title="Twitter" href="https://twitter.com/minimaxir" target="_blank"><i class="theme-icons theme-icons-white-brd theme-icons-md radius-circle fa fa-twitter"></i></a></li>
                        <li class="theme-icons-wrap"><a title="LinkedIn" href="https://linkedin.com/in/minimaxir" target="_blank"><i class="theme-icons theme-icons-white-brd theme-icons-md radius-circle fa fa-linkedin"></i></a></li>
                        <li class="theme-icons-wrap"><a title="E-Mail" href="mailto:max@minimaxir.com"><i class="theme-icons theme-icons-white-brd theme-icons-md radius-circle fa fa-envelope"></i></a></li>
                        <li class="theme-icons-wrap"><a title="GitHub" href="https://github.com/minimaxir" target="_blank"><i class="theme-icons theme-icons-white-brd theme-icons-md radius-circle fa fa-github"></i></a></li>
                        <li class="theme-icons-wrap"><a title="YouTube" href="https://youtube.com/minimaxir" target="_blank"><i class="theme-icons theme-icons-white-brd theme-icons-md radius-circle fa fa-youtube"></i></a></li>
                        <li class="theme-icons-wrap"><a title="RSS" href="/rss.xml"><i class="theme-icons theme-icons-white-brd theme-icons-md radius-circle fa fa-rss"></i></a></li>

                    </ul>
            </div>
        </div>
        </div>
    </section>
    
	

	
    

            </div>
    
    <!--========== FOOTER V8 ==========-->
    <footer id="footer" class="footer-v8">



        <!-- Copyright -->
        <div class="footer-v8-copyright">
            <div class="container text-center">
				Copyright &#169; 2018 Max Woolf. All Rights Reserved. 
                minimaxir.com is powered by Jekyll and GitHub Pages.
            </div>
        </div>
        <!-- Copyright -->
    </footer>
    <!--========== END FOOTER V8 ==========-->
</div>
<!-- END WRAPPER -->

<!-- Sidebar Content Overlay -->
<div class="sidebar-content-overlay"></div>
<!-- End Sidebar Content Overlay -->

<!-- Back To Top -->
<a href="javascript:void(0);" class="js-back-to-top back-to-top-theme"></a>
<!-- End Back To Top -->

<!--========== JAVASCRIPTS(Load javascripts at bottom, this will reduce page load time) ==========-->
<!-- BEGIN CORE PLUGINS -->
<!--[if lt IE 9]>
<script src="/assets/plugins/html5shiv.js"></script>
<script src="/assets/plugins/respond.min.js"></script>
<![endif]-->
<script type="text/javascript" src="/js/jquery.migrate.min.js"></script>
<script type="text/javascript" src="/js/bootstrap.min.js"></script>
<!-- END CORE PLUGINS -->

<!-- BEGIN PAGE LEVEL PLUGINS -->
<script type="text/javascript" src="/js/jquery.back-to-top.js"></script>
<!-- END PAGE LEVEL PLUGINS -->

<!-- BEGIN PAGE LEVEL SCRIPTS -->
<script type="text/javascript" src="/js/app.min.js"></script>
<script type="text/javascript" src="/js/header-sticky.js"></script>
<!-- END PAGE LEVEL SCRIPTS -->


<!--========== END JAVASCRIPTS ==========-->
  
</body>
<!-- END BODY -->

</html>