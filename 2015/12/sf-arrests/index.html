<!DOCTYPE html>
<html lang="en" class="no-js">

  <!-- HEAD -->
<head>
<meta charset="utf-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Analyzing San Francisco Crime Data to Determine When Arrests Frequently Occur</title>
<meta property="article:author" content="https://www.facebook.com/max.woolf" />
<meta name="description" content="The SF OpenData portal is a good source for detailed statistics about San Francisco. One of the most popular datasets on the portal is the SFPD Incidents dat...">
<link href="/rss.xml" rel="alternate" title="minimaxir | Max Woolf's Blog" type="application/atom+xml">
<link rel="canonical" href="http://minimaxir.com/2015/12/sf-arrests/">

<!-- Mobile Metas -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">


 <meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@minimaxir">
<meta name="twitter:creator" content="@minimaxir">

  <meta name="twitter:title" content="Analyzing San Francisco Crime Data to Determine When Arrests Frequently Occur">


  <meta name="twitter:url" content="http://minimaxir.com/2015/12/sf-arrests/">


  <meta name="twitter:description" content="Spoilers: Most arrests in San Francisco happen Wednesdays at 4-5 PM. For some reason.">


  <meta name="twitter:image:src" content="http://minimaxir.com/img/sf-arrest-when-2.png">

 
 <meta content="minimaxir | Max Woolf's Blog" property="og:site_name">

  <meta content="Analyzing San Francisco Crime Data to Determine When Arrests Frequently Occur" property="og:title">


  <meta content="article" property="og:type">


  <meta content="Spoilers: Most arrests in San Francisco happen Wednesdays at 4-5 PM. For some reason." property="og:description">


  <meta content="http://minimaxir.com/2015/12/sf-arrests/" property="og:url">



  <meta content="http://minimaxir.com/img/sf-arrest-when-2.png" property="og:image">


  
  <meta content="Data" property="article:section">
  


  



      <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">

    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="white">
    <meta name="apple-mobile-web-app-title" content="minimaxir">
    <link rel="apple-touch-icon-precomposed" href="apple-touch-icon-precomposed.png">

<link rel="apple-touch-icon" sizes="57x57" href="http://minimaxir.com/favicon/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="http://minimaxir.com/favicon/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="http://minimaxir.com/favicon/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="http://minimaxir.com/favicon/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="http://minimaxir.com/favicon/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="http://minimaxir.com/favicon/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="http://minimaxir.com/favicon/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="http://minimaxir.com/favicon/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="http://minimaxir.com/favicon/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="http://minimaxir.com/favicon/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://minimaxir.com/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="http://minimaxir.com/favicon/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="http://minimaxir.com/favicon/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="http://minimaxir.com/favicon/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">

<!-- BEGIN GLOBAL MANDATORY STYLES -->
  <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,300italic,400,400italic,700' rel='stylesheet' type='text/css'>

<link href="/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
<link href="/css/minimaxir.css" rel="stylesheet" type="text/css"/>
<!-- END GLOBAL MANDATORY STYLES -->

<!-- BEGIN THEME STYLES -->
<link href="/css/global.css" rel="stylesheet" type="text/css"/>
<!-- END THEME STYLES -->

<!-- BEGIN JQUERY -->
<script type="text/javascript" src="/js/jquery.min.js"></script>
<!-- END JQUERY -->



  <script>
   $(document).ready(function() {
 
  // LinkedIn
	$( ".social.linkedin" ).children().each(function(index,value) {
	var linkedin_button = $(this);
	var url = linkedin_button.attr("data");

  jQuery.getJSON("http://www.linkedin.com/countserv/count/share?url="+url+"&format=jsonp&callback=?", function(data) {
  linkedin_button.html("<i class=\"fa fa-linkedin\"></i><span class=\"count hidden-xs\"> " + data.count + "</span>");
  });
  });
  });
  </script>
  
</head>
<!-- END HEAD -->
  <!-- WRAPPER -->
<div class="wrapper">
    <!--========== HEADER TRANSPARENT ==========-->
    <header class="header-transparent header-transparent-bb navbar-fixed-top header-sticky">
        <!-- Navbar -->
        <nav class="navbar mega-menu" role="navigation">
            <div class="container">
                <!-- Brand and toggle get grouped for better mobile display -->
                <div class="menu-container">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="toggle-icon"></span>
                    </button>

                    <!-- Navbar Actions -->
                    <div class="navbar-actions">

                    </div>
                    <!-- End Navbar Actions -->

                    <!-- Logo -->
                    <div class="navbar-logo">
                        <a class="navbar-logo-wrap" href="/">
                            <img class="navbar-logo-img navbar-logo-img-white" src="/minimaxir-light.png" alt="minimaxir">
                            <img class="navbar-logo-img navbar-logo-img-dark" src="/minimaxir-dark.png" alt="minimaxir">
                        </a>
                    </div>
                    <!-- End Logo -->
                </div>

                <!-- Collect the nav links, forms, and other content for toggling -->
                <div class="collapse navbar-collapse nav-collapse">
                    <div class="menu-container">
                        <ul class="nav navbar-nav">

                            <li class="nav-item">
                                <a class="nav-item-child" href="/about">
                                    About
                                </a>
                            </li>

                            <li class="nav-item">
                                <a class="nav-item-child" href="/portfolio">
                                    Code Portfolio
                                </a>


                            </li>
                            <li class="nav-item">
                                <a class="nav-item-child" href="/data-portfolio">
                                    Data Portfolio
                                </a>


                            </li>
                             <li class="nav-item">
                                <a class="nav-item-child" href="https://www.patreon.com/minimaxir" target="_blank">
                                    Patreon
                                </a>


                            </li>

                        </ul>
                    </div>
                </div>
                <!-- End Navbar Collapse -->
            </div>
            <!--// End Container-->
        </nav>
        <!-- Navbar -->
    </header>
    <!--========== END HEADER TRANSPARENT ==========-->

        <!--========== BREADCRUMBS V5 ==========-->
    
    
	
	
    
    
    
    <section class="breadcrumbs-v5" style="background: url('/img/sf-arrest-when-2.png') no-repeat center center; background-size: cover;">
    
        <div class="container">
            <h1 class="breadcrumbs-v5-title">Analyzing San Francisco Crime Data to Determine When Arrests Frequently Occur</h1>
            <span class="breadcrumbs-v5-subtitle">December 4, 2015
            
    
              <span class="sharing index" style="float: right">
  
		  <span class="social facebook"><a href="https://www.facebook.com/share.php?u=http://minimaxir.com/2015/12/sf-arrests/"  onclick="javascript:window.open(this.href,
  '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=350,width=600');return false;" data="http://minimaxir.com/2015/12/sf-arrests/"><i class="fa fa-facebook"></i><span class="count hidden-xs"></span></a></span>
  
		<span class="social twitter"><a href="http://twitter.com/home/?status=Analyzing San Francisco Crime Data to Determine When Arrests Frequently Occur - http://minimaxir.com/2015/12/sf-arrests/ - via @minimaxir"  onclick="javascript:window.open(this.href,
  '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=350,width=600');return false;" data=http://minimaxir.com/2015/12/sf-arrests/><i class="fa fa-twitter"></i><span class="count hidden-xs"></span></a> </span>

  <span  class="social linkedin"><a href="http://www.linkedin.com/shareArticle?mini=true&title=&url=http://minimaxir.com/2015/12/sf-arrests/"  onclick="javascript:window.open(this.href,
  '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=450,width=600');return false;" data=http://minimaxir.com/2015/12/sf-arrests/><i class="fa fa-linkedin"></i><span class="count hidden-xs"> -</span></a> </span>
   
			</span>
            
            </span>
        </div>
    </section>
    
    
    <!--========== END BREADCRUMBS V5 ==========-->
  
  <!-- BEGIN BODY -->
<body>

  
      <!--========== BACKGROUND COLOR SKY LIGHT ==========-->
    <div class="bg-color-sky-light">

        
        <!--========== PAGE CONTENT ==========-->
        <div class="content-sm container">
        
            
		
        
            <div class="row">
                <div class="col-md-9 md-margin-b-50">
                    <!-- Blog Grid -->
                    <article class="blog-grid margin-b-30">
                        <!-- Image -->
                        <!--<img class="img-responsive" src="/assets/img/1920x1080/20.jpg" alt="">-->
                        <!-- End Image -->

                        <!-- Blog Grid Content -->
						<div class="blog-grid-content">
						<p>The <a href="https://data.sfgov.org">SF OpenData portal</a> is a good source for detailed statistics about San Francisco. One of the most popular datasets on the portal is the <a href="https://data.sfgov.org/Public-Safety/SFPD-Incidents-from-1-January-2003/tmnf-yvry">SFPD Incidents dataset</a>, which contains a tabular list of 1,842,050 reports (at time of writing) from 2003 to present.</p>

<p><img src="/img/sf-arrests/incident-data.png" alt=""></p>

<p>The data can be exported into a 377.9 MB CSV; not large enough to be considered &ldquo;big data,&rdquo; but still too heavy for programs like Excel to process efficiently. Let&rsquo;s take a look at the data using <a href="https://www.r-project.org">R</a> and see if there&rsquo;s anything interesting.</p>

<h2>Processing the Data</h2>

<p>For this article, I&rsquo;m going to do something different and illustrate the data processing step-by-step, both as a teaching tool, and to show that I am not using vague methodology to generate a narratively-convenient conclusion. <em>For more detailed code and output, a <a href="https://github.com/minimaxir/sf-arrests-when-where/blob/master/crime_data_sf.ipynb">Jupyter notebook</a> containing the code and visualizations used in this article is available open-source on GitHub.</em></p>

<p>Loading a 1.9 million row file into R can take awhile, even on modern computers with a SSD. Enter <code>readr</code>, <a href="https://github.com/hadley/readr">another R package</a> by <code>ggplot2</code> author Hadley Wickham, which grants access to a <code>read_csv()</code> function that has nearly 10x the speed of the base <code>read.csv()</code> R function, with more sensible defaults too.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">path</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"~/Downloads/SFPD_Incidents_-_from_1_January_2003.csv"</span><span class="w">

</span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></code></pre></figure>

<p>In memory, the data set is 180.9 MB, and removing a few useless columns (e.g. IncidentNum) further reduces the size to 126.9 MB. Since there are many redundancies in the row data (e.g. only 10 distinct PdDistrict values), R can perform memory optimizations.</p>

<p>You may have noticed in the first article image that the text data in some of the columns is in ALL CAPS, which would look ugly if the text was used in a data visualization. We can create a helper function to convert a column of text values into proper case through the use of <a href="http://stackoverflow.com/questions/15776732/how-to-convert-a-vector-of-strings-to-title-case">regular expression shenanigans</a>.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">proper_case</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">return</span><span class="w"> </span><span class="p">(</span><span class="n">gsub</span><span class="p">(</span><span class="s2">"\\b([A-Z])([A-Z]+)"</span><span class="p">,</span><span class="w"> </span><span class="s2">"\\U\\1\\L\\2"</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">perl</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">))</span><span class="w">
</span><span class="p">}</span></code></pre></figure>

<p>Now we can do more through processing using <code>dplyr</code>, <a href="https://github.com/hadley/dplyr"><em>another</em> Hadley Wickham R package</a>. dplyr is a utility that makes R easier to use: it provides a new syntax that allows data manipulation with intuitive function names, the functions can be chained using the <code>%&gt;%</code> operator for efficiency, and all data processing is <em>significantly</em> faster due to a C++ code base. (Fun fact: before the release of dplyr, I intended to quit using R for data analysis in favor of Python. Base R syntax is <em>that</em> difficult to use.)</p>

<p>In dplyr, <code>mutate</code> allows the creation and transformation of columns. We will transform the text columns by running the columns through the <code>proper_case</code> function earlier:</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">mutate</span><span class="p">(</span><span class="n">Category</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">proper_case</span><span class="p">(</span><span class="n">Category</span><span class="p">),</span><span class="w">
                 </span><span class="n">Descript</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">proper_case</span><span class="p">(</span><span class="n">Descript</span><span class="p">),</span><span class="w">
                 </span><span class="n">PdDistrict</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">proper_case</span><span class="p">(</span><span class="n">PdDistrict</span><span class="p">),</span><span class="w">
                 </span><span class="n">Resolution</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">proper_case</span><span class="p">(</span><span class="n">Resolution</span><span class="p">))</span></code></pre></figure>

<p>After all that, the data looks like:</p>

<p><img src="/img/sf-arrests/processed-table.png" alt=""></p>

<p>Much better!</p>

<p>However, many of the records have a &ldquo;None&rdquo; value for Resolution. This implies that the police appeared at the incident but did no action, which isn&rsquo;t that helpful for analysis. How about we look at incidents which resulted in an arrest?</p>

<p>dplyr&rsquo;s  <code>filter</code> command does that, and we can use <code>grepl()</code> to do a text search for each Resolution value for the presence of &ldquo;Arrest&rdquo;.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">df_arrest</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">filter</span><span class="p">(</span><span class="n">grepl</span><span class="p">(</span><span class="s2">"Arrest"</span><span class="p">,</span><span class="w"> </span><span class="n">Resolution</span><span class="p">))</span></code></pre></figure>

<p>That&rsquo;s it! There are 587,499 arrests total in the dataset.</p>

<h2>Arrests Over Time</h2>

<p>One of the most simple data visualizations is a line chart, and it&rsquo;s a good starting point to use for analyzing arrests. Has the number of daily arrests been changing over time? dplyr and ggplot2 make this very easy to visualize in R.</p>

<p>First, the Date column must be formatted as a Date internally in R instead of text. Then we <code>group_by</code> the Date, and then use <code>summarize</code> to perform an aggregate on each group; in this case, count how many entries for the group. (<code>n()</code> is a convenient shortcut). We can also ensure that the dates are in ascending order.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">df_arrest_daily</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df_arrest</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
                    </span><span class="n">mutate</span><span class="p">(</span><span class="n">Date</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">as.Date</span><span class="p">(</span><span class="n">Date</span><span class="p">,</span><span class="w"> </span><span class="s2">"%m/%d/%Y"</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
                    </span><span class="n">group_by</span><span class="p">(</span><span class="n">Date</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
                    </span><span class="n">summarize</span><span class="p">(</span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">())</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
                    </span><span class="n">arrange</span><span class="p">(</span><span class="n">Date</span><span class="p">)</span></code></pre></figure>

<p><img src="/img/sf-arrests/date-table.png" alt=""></p>

<p>Nifty! However, keep in mind that there are thousands of days in this dataset.</p>

<p>Now we can make a pretty line chart in ggplot2. Here&rsquo;s the code, and I will explain what everything does afterward:</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">plot</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ggplot</span><span class="p">(</span><span class="n">df_arrest_daily</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Date</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">geom_line</span><span class="p">(</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#F2CA27"</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">geom_smooth</span><span class="p">(</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#1A1A1A"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">fte_theme</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">scale_x_date</span><span class="p">(</span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">date_breaks</span><span class="p">(</span><span class="s2">"2 years"</span><span class="p">),</span><span class="w"> </span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">date_format</span><span class="p">(</span><span class="s2">"%Y"</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Date of Arrest"</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"# of Police Arrests"</span><span class="p">,</span><span class="w"> </span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Daily Police Arrests in San Francisco from 2003 – 2015"</span><span class="p">)</span></code></pre></figure>

<ul>
<li><code>ggplot()</code> sets up the base chart and axes.</li>
<li><code>geom_line()</code> creates the line for the line chart. &ldquo;color&rdquo; and &ldquo;size&rdquo; parameters do just that.</li>
<li><code>geom_smooth()</code> adds a smoothing spline on top of the chart to serve as a trendline, which is helpful since there are a lot of points.</li>
<li><code>fte_theme()</code> is my theme based on the FiveThirtyEight style.</li>
<li><code>scale_x_date()</code> explicitly sets the x-axis to scale with date values. However, there are a few extremely useful formatting parameters with this function: &ldquo;breaks&rdquo; lets you set the chart breaks in plain English, and &ldquo;labels&rdquo; lets you format the dates at this breaks; in this case, there are breaks every 2 years, and only the year will be displayed for minimalism.</li>
<li><code>labs()</code> is a quick shortcut for labeling your axes and plot (<em>always</em> label!)</li>
</ul>

<p>Running the code and saving the output results in this image:</p>

<p><img src="/img/sf-arrests/sf-arrest-when-1.png" alt=""></p>

<p>The line chart has high variation due to the number of points (in retrospect, a 30-day moving average of arrests would work better visually). As the trendline indicates, the trend is actually <em>multimodal</em>, with daily arrest peaks in 2009 and 2014. Definitely interesting. The number of arrests appears to be on a downward trend since then.</p>

<p>The next step is to look into possible answers for the day-by-day variation.</p>

<h2>When Do Arrests Happen?</h2>

<p>One of my go-to data visualizations is a heat map of times of week; in this case, we can find which day-of-week and time-of-day when the most Arrests occur in San Francisco, and compare that with other time slots at a glance.</p>

<p>This requires the Hour and Day-of-Week to be present in separate columns: we have a DOY column already, but we need to parse the Hour component out of the HH:MM values in the Time column.</p>

<p>This requires another helper function which uses <code>strsplit()</code> to split a single time value to Hour and Minute components, take the first value (Hour), and convert that value to a numeric value (instead of text) For example, &ldquo;09:40&rdquo; input returns 9.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">get_hour</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">return</span><span class="w"> </span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">strsplit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="s2">":"</span><span class="p">)[[</span><span class="m">1</span><span class="p">]][</span><span class="m">1</span><span class="p">]))</span><span class="w">
</span><span class="p">}</span></code></pre></figure>

<p>Unfortunately, this will not work for an entire column. Using <code>sapply()</code> applies a specified function to each element in a column, which accomplishes the same goal.</p>

<p>The goal is to count how many Arrests occur for a given day-of-week and hour combination. In dplyr, we <code>group_by</code> both &ldquo;DayOfWeek&rdquo; and &ldquo;Hour&rdquo;, and then use <code>summarize</code> again.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">df_arrest_time</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df_arrest</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
                    </span><span class="n">mutate</span><span class="p">(</span><span class="n">Hour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sapply</span><span class="p">(</span><span class="n">Time</span><span class="p">,</span><span class="w"> </span><span class="n">get_hour</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
                    </span><span class="n">group_by</span><span class="p">(</span><span class="n">DayOfWeek</span><span class="p">,</span><span class="w"> </span><span class="n">Hour</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
                    </span><span class="n">summarize</span><span class="p">(</span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">())</span></code></pre></figure>

<p><img src="/img/sf-arrests/dow-table.png" alt=""></p>

<p>A few more tweaks are done (off camera) to convert the Hours to representations like &ldquo;12 PM&rdquo; and get everything in the correct order.</p>

<p>Now, it&rsquo;s time to make the heatmap using <code>ggplot2</code>. Here&rsquo;s the code, and I will explain what the new functions do:</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">plot</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ggplot</span><span class="p">(</span><span class="n">df_arrest_time</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Hour</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DayOfWeek</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">geom_tile</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">fte_theme</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">theme</span><span class="p">(</span><span class="n">...</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Hour of Arrest (Local Time)"</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Day of Week of Arrest"</span><span class="p">,</span><span class="w"> </span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"# of Police Arrests in San Francisco from 2003 – 2015, by Time of Arrest"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">scale_fill_gradient</span><span class="p">(</span><span class="n">low</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"white"</span><span class="p">,</span><span class="w"> </span><span class="n">high</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#27AE60"</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">comma</span><span class="p">)</span></code></pre></figure>

<ul>
<li><code>geom_title()</code> creates tiles. (instead of lines)</li>
<li><code>theme()</code> is needed for a few additional theme tweaks to get the gradient bar to render (tweaks not shown)</li>
<li><code>scale_fill_gradient()</code> tells the tiles to fill on a gradient, from white as the lowest value to a green as the highest value. The &ldquo;labels = comma&rdquo; parameter is a hidden helpful tip to allow any values in the legend to show with commas.</li>
</ul>

<p>Putting it all together:</p>

<p><img src="/img/sf-arrests/sf-arrest-when-2.png" alt=""></p>

<p>The heatmap is an intuitive result. Arrests don&rsquo;t happen in the early morning, and arrests tend to be elevated Friday and Saturday night, when everyone is out on the town.</p>

<p>However, the peak arrest time is apparently on Wednesdays at 4-5 PM. Wednesdays and the 4-5 PM timeslot in general have elevated arrest frequency, too. Why is that the case?</p>

<p>This requires further analysis.</p>

<h2>Facets of Arrest</h2>

<p>Perhaps the odd results can be explained by another lurking variable. Logically, certain types of crime, such as DUIs, should happen primarily at night. ggplot2 has tool known as faceting that makes such analysis easy by rendering a chart for each instance of another value in another variable. In this case, with only <em>one</em> line of ggplot2 code, we can plot a heatmap for <em>each</em> of the top types of arrests, and see if there is any significant variation in the heatmap.</p>

<p>After quickly using dplyr to aggregate and sort the top categories of arrest, by number of occurrences:</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">df_top_crimes</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df_arrest</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
                    </span><span class="n">group_by</span><span class="p">(</span><span class="n">Category</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
                    </span><span class="n">summarize</span><span class="p">(</span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">())</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
                    </span><span class="n">arrange</span><span class="p">(</span><span class="n">desc</span><span class="p">(</span><span class="n">count</span><span class="p">))</span></code></pre></figure>

<p><img src="/img/sf-arrests/top-crimes.png" alt=""></p>

<p>&ldquo;Other Offenses&rdquo; is a catch-all, so we will ignore that. Filter on the top 18 types of crime excluding Other Offenses and aggregate as usual.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">df_arrest_time_crime</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df_arrest</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
                    </span><span class="n">filter</span><span class="p">(</span><span class="n">Category</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="n">df_top_crimes</span><span class="o">$</span><span class="n">Category</span><span class="p">[</span><span class="m">2</span><span class="o">:</span><span class="m">19</span><span class="p">])</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
                    </span><span class="n">mutate</span><span class="p">(</span><span class="n">Hour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sapply</span><span class="p">(</span><span class="n">Time</span><span class="p">,</span><span class="w"> </span><span class="n">get_hour</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
                    </span><span class="n">group_by</span><span class="p">(</span><span class="n">Category</span><span class="p">,</span><span class="w"> </span><span class="n">DayOfWeek</span><span class="p">,</span><span class="w"> </span><span class="n">Hour</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
                    </span><span class="n">summarize</span><span class="p">(</span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">())</span></code></pre></figure>

<p>Time for the heat map! The <code>ggplot</code> code is nearly identical to the previous heatmap code, except we add <code>facet_wrap()</code>.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">plot</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ggplot</span><span class="p">(</span><span class="n">df_arrest_time_crime</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Hour</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DayOfWeek</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">geom_tile</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">fte_theme</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">theme</span><span class="p">(</span><span class="n">...</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Hour of Arrest (Local Time)"</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Day of Week of Arrest"</span><span class="p">,</span><span class="w"> </span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"# of Police Arrests in San Francisco from 2003 – 2015, by Category and Time of Arrest"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">scale_fill_gradient</span><span class="p">(</span><span class="n">low</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"white"</span><span class="p">,</span><span class="w"> </span><span class="n">high</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#2980B9"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="w"> </span><span class="n">Category</span><span class="p">,</span><span class="w"> </span><span class="n">nrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">6</span><span class="p">)</span></code></pre></figure>

<p><img src="/img/sf-arrests/sf-arrest-when-3.png" alt=""></p>

<p>Easy visualization to make, but it&rsquo;s not fully correct. There can only be one scale for the whole visualization, which is why the categories with lots of arrests appear colored and others do not (however, it shows that Drugs/Narcotics arrests are a large contributor to the Wednesday emphasis of the data). We need to normalize the counts by facet. dplyr has a nice trick for normalization: group by the normalization variable (Category), then mutate to add a column based on the aggregate for each unique value.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">df_arrest_time_crime</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df_arrest_time_crime</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
                            </span><span class="n">group_by</span><span class="p">(</span><span class="n">Category</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
                            </span><span class="n">mutate</span><span class="p">(</span><span class="n">norm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count</span><span class="o">/</span><span class="nf">sum</span><span class="p">(</span><span class="n">count</span><span class="p">))</span></code></pre></figure>

<p><img src="/img/sf-arrests/crime-norm.png" alt=""></p>

<p>Setting the &ldquo;fill&rdquo; to &ldquo;norm&rdquo; and rerunning the heatmap code yields:</p>

<p><img src="/img/sf-arrests/sf-arrest-when-4.png" alt=""></p>

<p>Now things get interesting.</p>

<p>Prostitution has the most notably unique behavior, which high concentrations of arrests at night on weekdays. Drunkenness and DUIs have high concentrations at night on weekends. And Disorderly Conduct has a high concentration of arrests at 5 AM on weekdays? That&rsquo;s not intuitive.</p>

<p>Notably, some offenses have relatively random times of arrests, such as Stolen Property and Vehicle Theft.</p>

<p>However, this doesn&rsquo;t help explain why arrests tend to happen Wednesdays/4-5PM. Maybe faceting by another variable will provide more information.</p>

<p>Perhaps Police district? Maybe some PDs in San Francisco are more zealous than others. Since we created a code workflow earlier, we can apply it to any other variable very easily; in this case, it&rsquo;s mostly just replacing instances of &ldquo;Category&rdquo; with &ldquo;PdDistrict.&rdquo;</p>

<p>Doing thus yields this heatmap.</p>

<p><img src="/img/sf-arrests/sf-arrest-when-5.png" alt=""></p>

<p>Which isn&rsquo;t helpful. The charts are mostly identical to each other, and to the original heatmap. (Central Station (<a href="http://www.sf-police.org/Modules/ShowDocument.aspx?documentID=27554">coverage map</a>), however, has activity correlated to Drunkenness arrests.)</p>

<p>Perhaps the frequency of arrests is correlated to the time of year? How about faceting by month?</p>

<p><img src="/img/sf-arrests/sf-arrest-when-6.png" alt=""></p>

<p>Nope. Zero difference.</p>

<p>Last try. As shown in the line chart, the # of Arrests has oscillated over the years. Perhaps there&rsquo;s a specific year that&rsquo;s skewing the results. Let&rsquo;s facet by Year.</p>

<p><img src="/img/sf-arrests/sf-arrest-when-7.png" alt=""></p>

<p>Nope<sup>2.</sup> 2010-2012 have elevated Wednesday activity, but not by much.</p>

<p>This is frustrating. As of this posting, I don&rsquo;t have an obvious answer for the elevated arrests Wednesdays at 4-5PM. That being said, there definitely is still more to learn from looking at SF Crime data, although that&rsquo;s enough analysis for the time being.</p>

<p><a href="http://minimaxir.com/2015/12/sf-arrest-maps/">My next article</a> discusses how to plot arrests on a map using the <code>ggmap</code> R library, which hopefully will provide more answers. The <a href="https://github.com/minimaxir/sf-arrests-when-where">GitHub repository</a> contains a Jupyter notebook with code and visualizations for both for this article, and for the upcoming ggmap visualizations (if you want a sneak peek) which will show <em>where</em> arrests in San Francisco frequently occur.</p>

<hr>

<p><em>If you use the code or data visualization designs contained within this article, it would be greatly appreciated if proper attribution is given back to this article and/or myself. Thanks!</em></p>

                        
                        
                        <div class="alert alert-warning" role="alert">

     <p>If you liked this blog post, I have set up a <a href="https://www.patreon.com/minimaxir">Patreon</a> to fund my machine learning/deep learning/software/hardware needs for my future crazy yet cool projects, and any monetary contributions to the Patreon are appreciated and will be put to good creative use.</p>

    
</div>
                        
						
            			 <div class="breadcrumbs-v5-subtitle sharing-post" style="color: #999 !important; padding-top:10px; border-top: 1px solid #eee">Share this article!


              <span class="sharing index" style="float: right; color: #999 !important;">
  
		  <span class="social facebook"><a href="https://www.facebook.com/share.php?u=http://minimaxir.com/2015/12/sf-arrests/"  onclick="javascript:window.open(this.href,
  '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=350,width=600');return false;" data="http://minimaxir.com/2015/12/sf-arrests/"><i class="fa fa-facebook"></i><span class="count hidden-xs"></span></a></span>
  
		<span class="social twitter"><a href="http://twitter.com/home/?status=Analyzing San Francisco Crime Data to Determine When Arrests Frequently Occur - http://minimaxir.com/2015/12/sf-arrests/ - via @minimaxir"  onclick="javascript:window.open(this.href,
  '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=350,width=600');return false;" data=http://minimaxir.com/2015/12/sf-arrests/><i class="fa fa-twitter"></i><span class="count hidden-xs"></span></a> </span>

  <span  class="social linkedin"><a href="http://www.linkedin.com/shareArticle?mini=true&title=&url=http://minimaxir.com/2015/12/sf-arrests/"  onclick="javascript:window.open(this.href,
  '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=450,width=600');return false;" data=http://minimaxir.com/2015/12/sf-arrests/><i class="fa fa-linkedin"></i><span class="count hidden-xs"> -</span></a> </span>

   </span>
   </div>
						</div>
                        <!-- End Blog Grid Content -->
                        
                        
                        
                    </article>
                    <!-- End Blog Grid -->

 					

                    <!-- Blog Comment -->
                    <div class="blog-comments bg-color-white margin-b-30">
                        <div class="blog-single-post-content">

						

<script type="text/javascript">
      var disqus_shortname = 'minimaxir';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://minimaxir.com/2015/12/sf-arrests/';
        var disqus_url = 'http://minimaxir.com/2015/12/sf-arrests/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>

<div id="disqus_thread"></div>



                        </div>
                    </div>
                    <!-- End Blog Comment -->
                    
                    
                </div>

			<!--========== BLOG SIDEBAR ==========-->
<div class="col-md-3">



    <!-- Blog Author -->
    <div class="blog-sidebar margin-b-30">
        <div class="blog-sidebar-heading">
            <h4 class="blog-sidebar-heading-title">Author</h4>
        </div>

        <img src="/MaxFB.jpg" title="Stop mousing over me! I'm not a XKCD comic!" class="img-responsive hidden-xs hidden-sm"></img>

        <div class="blog-sidebar-content">
            <!-- Blog Author Bio -->
             <p><strong>Max Woolf (@minimaxir)</strong> is an Associate Data Scientist at BuzzFeed in San Francisco. He is also an ex-Apple employee and Carnegie Mellon University graduate.</p>

<p>In his spare time, Max uses <a href="https://www.python.org/">Python</a> to gather data from public APIs and <a href="http://ggplot2.org/">ggplot2</a> to plot plenty of pretty charts from that data. On special occasions, he uses <a href="https://github.com/fchollet/keras">Keras</a> for fancy deep learning projects.</p>

<p>You can learn more about Max <a href="/about">here</a>, view his data analysis portfolio <a href="/data-portfolio">here</a>, or view his coding portfolio <a href="/portfolio">here</a>. </p>


            <ul class="list-inline" style="padding-top:10px; margin-top: 20px; border-top: 1px solid #ebeef6">
                <li class="theme-icons-wrap"><a title="Facebook" href="https://facebook.com/max.woolf" target="_blank"><i class="theme-icons theme-icons-grey-light-bg theme-icons-xs radius-circle fa fa-facebook"></i></a></li>
                <li class="theme-icons-wrap"><a title="Twitter" href="https://twitter.com/minimaxir" target="_blank"><i class="theme-icons theme-icons-grey-light-bg theme-icons-xs radius-circle fa fa-twitter"></i></a></li>
                <li class="theme-icons-wrap"><a title="LinkedIn" href="https://linkedin.com/in/minimaxir" target="_blank"><i class="theme-icons theme-icons-grey-light-bg theme-icons-xs radius-circle fa fa-linkedin"></i></a></li>
                <li class="theme-icons-wrap"><a title="E-Mail" href="mailto:max@minimaxir.com"><i class="theme-icons theme-icons-grey-light-bg theme-icons-xs radius-circle fa fa-envelope"></i></a></li>
                <li class="theme-icons-wrap"><a title="GitHub" href="https://github.com/minimaxir" target="_blank"><i class="theme-icons theme-icons-grey-light-bg theme-icons-xs radius-circle fa fa-github"></i></a></li>
                <li class="theme-icons-wrap"><a title="YouTube" href="https://youtube.com/minimaxir" target="_blank"><i class="theme-icons theme-icons-grey-light-bg theme-icons-xs radius-circle fa fa-youtube"></i></a></li>
                <li class="theme-icons-wrap"><a title="RSS" href="/rss.xml"><i class="theme-icons theme-icons-grey-light-bg theme-icons-xs radius-circle fa fa-rss"></i></a></li>
            </ul>
            <!-- End Blog Author Bio -->
        </div>
    </div>
    <!-- End Blog Author -->

    <!-- Blog Recent Posts -->
    <div class="blog-sidebar margin-b-30">
        <div class="blog-sidebar-heading">
            <h4 class="blog-sidebar-heading-title">Recent Posts</h4>
        </div>
        <div class="blog-sidebar-content" style="position: relative; overflow: visible;">

            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="/2018/07/imdb-data-analysis/">Analyzing IMDb Data The Intended Way, with R and ggplot2</a></h5>
                    <small class="latest-tuts-content-time"> Jul 16, 2018</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="/2018/05/text-neural-networks/">How to Quickly Train a Text-Generating Neural Network for Free</a></h5>
                    <small class="latest-tuts-content-time"> May 18, 2018</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="/2018/03/basketball-shots/">Visualizing One Million NCAA Basketball Shots</a></h5>
                    <small class="latest-tuts-content-time"> Mar 19, 2018</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="/2018/02/stack-overflow-questions/">A Visual Overview of Stack Overflow's Question Tags</a></h5>
                    <small class="latest-tuts-content-time"> Feb 9, 2018</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="/2017/11/benchmark-gpus/">Benchmarking Modern GPUs for Maximum Cloud Cost Efficiency in Deep Learning</a></h5>
                    <small class="latest-tuts-content-time"> Nov 28, 2017</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="/2017/11/magic-the-gifening/">Making Magic: the GIFening</a></h5>
                    <small class="latest-tuts-content-time"> Nov 7, 2017</small>
                </div>
            </article>
            
        </div>
        <!-- End Blog Recent Posts -->
    </div>

    <!-- GitHub Top Repositories -->
    <div class="blog-sidebar margin-b-30">
        <div class="blog-sidebar-heading">
            <h4 class="blog-sidebar-heading-title">GitHub Code Repositories</h4>
        </div>
        <div class="blog-sidebar-content" style="position: relative; overflow: visible;">

            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="http://github.com/minimaxir/big-list-of-naughty-strings" target="_blank">Big List of Naughty Strings</a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-star"></i> 21,523+</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="http://github.com/minimaxir/facebook-page-post-scraper" target="_blank">Facebook Page Post Scraper</a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-star"></i> 1,436+</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="http://github.com/minimaxir/textgenrnn" target="_blank">textgenrnn</a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-star"></i> 234+</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="http://github.com/minimaxir/reactionrnn" target="_blank">reactionrnn</a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-star"></i> 201+</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="http://github.com/minimaxir/system-dashboard" target="_blank">Multiplatform System Dashboard</a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-star"></i> 100+</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="http://github.com/minimaxir/tritonize" target="_blank">Tritonize</a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-star"></i> 9+</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="http://github.com/minimaxir/stylistic-word-clouds" target="_blank">Stylistic Word Clouds</a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-star"></i> 30+</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="http://github.com/minimaxir/char-embeddings" target="_blank">Pretrained Character Embeddings for Deep Learning and Automatic Text Generation</a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-star"></i> 8+</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="http://github.com/minimaxir/get-profile-data-of-repo-stargazers" target="_blank">Get GitHub Profile Data of All Stargazers of a GitHub Repo</a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-star"></i> 15+</small>
                </div>
            </article>
            
        </div>
    </div>

    <!-- End GitHub Top Repositories -->

    <!-- Data Top Repositories -->
    <div class="blog-sidebar margin-b-30">
        <div class="blog-sidebar-heading">
            <h4 class="blog-sidebar-heading-title">Data Analysis Notebooks</h4>
        </div>
        <div class="blog-sidebar-content" style="position: relative; overflow: visible;">

            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="http://minimaxir.com/notebooks/imgur-decline/" target="_blank">The Decline of Imgur on Reddit and the Rise of Reddit's Native Image Hosting</a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-cogs"></i> R, ggplot2</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="http://minimaxir.com/notebooks/keras-cntk/" target="_blank">Benchmarking CNTK on Keras: is it Better at Deep Learning than TensorFlow?</a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-cogs"></i> R, ggplot2</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="http://minimaxir.com/notebooks/char-tsne/" target="_blank">Pretrained Character Embeddings for Deep Learning and Automatic Text Generation</a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-cogs"></i> R, ggplot2</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="http://minimaxir.com/notebooks/predicting-arrests/" target="_blank">Predicting And Mapping Arrest Types in San Francisco</a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-cogs"></i> R, ggplot2, LightGBM</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="http://minimaxir.com/notebooks/amazon-spark/" target="_blank">Playing with 80 Million Amazon Product Review Ratings</a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-cogs"></i> R, ggplot2, Spark</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="http://minimaxir.com/notebooks/interactive-network/" target="_blank">How to Create an Interactive WebGL Network Graph</a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-cogs"></i> R, ggplot2, plotly</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="http://minimaxir.com/notebooks/first-comment/" target="_blank">What Percent of the Top-Voted Comments in Reddit Threads Were Also 1st Comment?</a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-cogs"></i> R, ggplot2</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="https://github.com/minimaxir/clickbait-cluster/blob/master/fb_news_53D_spark.ipynb" target="_blank">Processing Clusters of Clickbait Headlines </a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-cogs"></i> Python, Spark, word2vec</small>
                </div>
            </article>
            
            <article class="latest-tuts">
                <div class="latest-tuts-content">
                    <h5 class="latest-tuts-content-title"><a href="https://github.com/minimaxir/clickbait-cluster/blob/master/fb_news_53D_plotly.ipynb" target="_blank">Visualizing Clusters of Clickbait Headlines </a></h5>
                    <small class="latest-tuts-content-time"><i class="fa fa-cogs"></i> R, plotly</small>
                </div>
            </article>
            
        </div>
    </div>

    <!-- End GitHub Top Repositories -->



</div>
<!--========== END BLOG SIDEBAR ==========-->
			</div>
            <!--// end row -->
        </div>
        <!--========== END PAGE CONTENT ==========-->

    </div>
    <!--========== END BACKGROUND COLOR SKY LIGHT ==========-->
    



  
              <div class="wrapper">
    
	
	
    	 <section class="breadcrumbs-v5 bg-position-fixed" style="background: #2c3e50;  padding: 20px 0 20px !important;">
        <div class="container">
            <div class="row hero-index">
            <div class="col-sm-6 sm-margin-b-30 hidden-xs">
                <img src="/MaxFBInvert.png" title="Stop mousing over me! I'm not a XKCD comic!" class="img-responsive" style="border-radius: 30px; margin: 0 auto; max-height: 400px"></img>
            </div>
            <div class="col-sm-6 col-xs-12">

			
			<p><strong>Max Woolf (@minimaxir)</strong> is an Associate Data Scientist at BuzzFeed in San Francisco. He is also an ex-Apple employee and Carnegie Mellon University graduate.</p>

<p>In his spare time, Max uses <a href="https://www.python.org/">Python</a> to gather data from public APIs and <a href="http://ggplot2.org/">ggplot2</a> to plot plenty of pretty charts from that data. On special occasions, he uses <a href="https://github.com/fchollet/keras">Keras</a> for fancy deep learning projects.</p>

<p>You can learn more about Max <a href="/about">here</a>, view his data analysis portfolio <a href="/data-portfolio">here</a>, or view his coding portfolio <a href="/portfolio">here</a>. </p>

  
  
  <ul class="list-inline" style="padding-top:20px; margin-top: 40px; border-top: 1px solid white;">
                        <li class="theme-icons-wrap"><a title="Facebook" href="https://facebook.com/max.woolf" target="_blank"><i class="theme-icons theme-icons-white-brd theme-icons-md radius-circle fa fa-facebook"></i></a></li>
                        <li class="theme-icons-wrap"><a title="Twitter" href="https://twitter.com/minimaxir" target="_blank"><i class="theme-icons theme-icons-white-brd theme-icons-md radius-circle fa fa-twitter"></i></a></li>
                        <li class="theme-icons-wrap"><a title="LinkedIn" href="https://linkedin.com/in/minimaxir" target="_blank"><i class="theme-icons theme-icons-white-brd theme-icons-md radius-circle fa fa-linkedin"></i></a></li>
                        <li class="theme-icons-wrap"><a title="E-Mail" href="mailto:max@minimaxir.com"><i class="theme-icons theme-icons-white-brd theme-icons-md radius-circle fa fa-envelope"></i></a></li>
                        <li class="theme-icons-wrap"><a title="GitHub" href="https://github.com/minimaxir" target="_blank"><i class="theme-icons theme-icons-white-brd theme-icons-md radius-circle fa fa-github"></i></a></li>
                        <li class="theme-icons-wrap"><a title="YouTube" href="https://youtube.com/minimaxir" target="_blank"><i class="theme-icons theme-icons-white-brd theme-icons-md radius-circle fa fa-youtube"></i></a></li>
                        <li class="theme-icons-wrap"><a title="RSS" href="/rss.xml"><i class="theme-icons theme-icons-white-brd theme-icons-md radius-circle fa fa-rss"></i></a></li>

                    </ul>
            </div>
        </div>
        </div>
    </section>
    
	

	
    

            </div>
    
    <!--========== FOOTER V8 ==========-->
    <footer id="footer" class="footer-v8">



        <!-- Copyright -->
        <div class="footer-v8-copyright">
            <div class="container text-center">
				Copyright &#169; 2018 Max Woolf. All Rights Reserved. 
                minimaxir.com is powered by Jekyll and GitHub Pages.
            </div>
        </div>
        <!-- Copyright -->
    </footer>
    <!--========== END FOOTER V8 ==========-->
</div>
<!-- END WRAPPER -->

<!-- Sidebar Content Overlay -->
<div class="sidebar-content-overlay"></div>
<!-- End Sidebar Content Overlay -->

<!-- Back To Top -->
<a href="javascript:void(0);" class="js-back-to-top back-to-top-theme"></a>
<!-- End Back To Top -->

<!--========== JAVASCRIPTS(Load javascripts at bottom, this will reduce page load time) ==========-->
<!-- BEGIN CORE PLUGINS -->
<!--[if lt IE 9]>
<script src="/assets/plugins/html5shiv.js"></script>
<script src="/assets/plugins/respond.min.js"></script>
<![endif]-->
<script type="text/javascript" src="/js/jquery.migrate.min.js"></script>
<script type="text/javascript" src="/js/bootstrap.min.js"></script>
<!-- END CORE PLUGINS -->

<!-- BEGIN PAGE LEVEL PLUGINS -->
<script type="text/javascript" src="/js/jquery.back-to-top.js"></script>
<!-- END PAGE LEVEL PLUGINS -->

<!-- BEGIN PAGE LEVEL SCRIPTS -->
<script type="text/javascript" src="/js/app.min.js"></script>
<script type="text/javascript" src="/js/header-sticky.js"></script>
<!-- END PAGE LEVEL SCRIPTS -->


<!--========== END JAVASCRIPTS ==========-->
  
</body>
<!-- END BODY -->

</html>