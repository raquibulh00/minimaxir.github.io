<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Source Themes Academic 4.3.1"><meta name=author content="Max Woolf"><meta name=description content="It is pretty easy to scrape Facebook Posts data and make into a spreadsheet for easy analysis, although  there are a large number of gotchas."><link rel=alternate hreflang=en-us href=https://minimaxir.com/2015/07/facebook-scraper/><meta name=theme-color content=#2962ff><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin=anonymous><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.6.0/css/all.css integrity=sha384-aOkxzJ5uQz7WBObEZcHvV5JvRW3TUc2rNPA7pe3AwnsUohiw1Vj2Rgx2KSOkF5+h crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/github.min.css crossorigin=anonymous title=hl-light><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/dracula.min.css crossorigin=anonymous title=hl-dark disabled><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400italic,700|Source+Code+Pro:400,400italic,700&display=swap"><link rel=stylesheet href=/css/academic.min.a5099be3e049a7eefdcd4143a4af338a.css><link rel=stylesheet href=/css/academic.80785e08a563f430e47a4d753c8d9f2d.css><link rel=manifest href=/site.webmanifest><link rel=icon type=image/png href=/img/icon.png><link rel=apple-touch-icon type=image/png href=/img/icon-192.png><link rel=canonical href=https://minimaxir.com/2015/07/facebook-scraper/><meta property=twitter:card content=summary_large_image><meta property=twitter:site content=@minimaxir><meta property=twitter:creator content=@minimaxir><meta property=article:author content=https://www.facebook.com/max.woolf><meta property=og:site_name content="Max Woolf's Blog"><meta property=og:url content=https://minimaxir.com/2015/07/facebook-scraper/><meta property=og:type content=article><meta property=og:title content="How to Scrape Data From Facebook Page Posts for Statistical Analysis"><meta property=og:description content="It is pretty easy to scrape Facebook Posts data and make into a spreadsheet for easy analysis, although  there are a large number of gotchas."><meta property=og:image content=https://minimaxir.com/2015/07/facebook-scraper/featured.png><meta property=twitter:image content=https://minimaxir.com/2015/07/facebook-scraper/featured.png><meta property=og:locale content=en-us><meta property=article:published_time content=2015-07-20T08:00:00-07:00><meta property=article:modified_time content=2015-07-20T08:00:00-07:00><title>How to Scrape Data From Facebook Page Posts for Statistical Analysis | Max Woolf&#39;s Blog</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents><aside class=search-results id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class=col-6><h1>Search</h1></div><div class="col-6 col-search-close"><a class=js-search href=#><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box></div></section><section class=section-search-results><div id=search-hits></div></section></div></aside><nav class="navbar navbar-light fixed-top navbar-expand-lg py-0 compensate-for-scrollbar" id=navbar-main><div class=container><a class=navbar-brand href=/>Max Woolf&#39;s Blog</a>
<button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar aria-controls=navbar aria-expanded=false aria-label="Toggle navigation">
<span><i class="fas fa-bars"></i></span></button><div class="collapse navbar-collapse" id=navbar><ul class="navbar-nav mr-auto"><li class=nav-item><a class=nav-link href=/about/><span>About</span></a></li><li class=nav-item><a class=nav-link href=/post/><span>Posts</span></a></li><li class=nav-item><a class=nav-link href=/portfolio/><span>Portfolio</span></a></li></ul><ul class="navbar-nav ml-auto"><li class=nav-item><a class=nav-link href=https://www.patreon.com/minimaxir target=_blank rel=noopener><span><i class="fab fa-patreon mr-1"></i>Patreon</span></a></li><li class=nav-item><a class=nav-link href=https://github.com/minimaxir target=_blank rel=noopener><span><i class="fab fa-github-alt mr-1"></i>GitHub</span></a></li><li class=nav-item><a class="nav-link js-dark-toggle" href=#><i class="fas fa-moon" aria-hidden=true></i></a></li></ul></div></div></nav><article class=article itemscope itemtype=http://schema.org/Article><div class="article-container pt-3"><h1 itemprop=name>How to Scrape Data From Facebook Page Posts for Statistical Analysis</h1><meta content="2015-07-20 08:00:00 -0700 PDT" itemprop=datePublished><meta content="2015-07-20 08:00:00 -0700 PDT" itemprop=dateModified><div class=article-metadata><span class=article-date><time>July 20, 2015</time></span>
<span class=middot-divider></span><span class=article-reading-time>7 min read</span>
<span class=middot-divider></span><span class=article-categories><i class="fas fa-folder mr-1"></i><a href=/categories/tools/>Tools</a></span><div class=share-box aria-hidden=true><ul class=share><li><a href="https://twitter.com/intent/tweet?url=https://minimaxir.com/2015/07/facebook-scraper/&amp;text=How%20to%20Scrape%20Data%20From%20Facebook%20Page%20Posts%20for%20Statistical%20Analysis" target=_blank rel=noopener class=share-btn-twitter><i class="fab fa-twitter"></i></a></li><li><a href="https://www.facebook.com/sharer.php?u=https://minimaxir.com/2015/07/facebook-scraper/&amp;t=How%20to%20Scrape%20Data%20From%20Facebook%20Page%20Posts%20for%20Statistical%20Analysis" target=_blank rel=noopener class=share-btn-facebook><i class="fab fa-facebook-f"></i></a></li><li><a href="mailto:?subject=How%20to%20Scrape%20Data%20From%20Facebook%20Page%20Posts%20for%20Statistical%20Analysis&amp;body=https://minimaxir.com/2015/07/facebook-scraper/" target=_blank rel=noopener class=share-btn-email><i class="fas fa-envelope"></i></a></li><li><a href="https://www.linkedin.com/shareArticle?url=https://minimaxir.com/2015/07/facebook-scraper/&amp;title=How%20to%20Scrape%20Data%20From%20Facebook%20Page%20Posts%20for%20Statistical%20Analysis" target=_blank rel=noopener class=share-btn-linkedin><i class="fab fa-linkedin-in"></i></a></li><li><a href="https://reddit.com/submit?url=https://minimaxir.com/2015/07/facebook-scraper/&amp;title=How%20to%20Scrape%20Data%20From%20Facebook%20Page%20Posts%20for%20Statistical%20Analysis" target=_blank rel=noopener class=share-btn-reddit><i class="fab fa-reddit-alien"></i></a></li></ul></div></div></div><div class=article-container><div class=article-style itemprop=articleBody><div class="alert alert-warning"><div>UPDATE April 2018: Due to changes Facebook has made to the Graph API, the API will no longer return every post as noted in this article.</div></div><p>One of the first data scrapers I wrote for the purpose of statistical analysis was a Facebook Graph API scraper, in order to determine <a href=http://minimaxir.com/2013/06/big-social-data/ target=_blank>which words are the most important</a> in a Facebook Page status update. However, the v2.0 update to the Facebook API unsurprisingly broke the scraper.</p><p>Now that <a href=https://developers.facebook.com/blog/post/2015/07/08/graph-api-v2.4/ target=_blank>v2.4 of the Graph API is released</a>, I gave the Facebook Graph API another look. Turns out, it&rsquo;s pretty easy to scrape and make into a spreadsheet for easy analysis, although like with any other scrapers, there are a large number of gotchas.</p><h2 id=feasibility>Feasibility</h2><p><img src=/img/facebook-scraper/nyt_sample.png alt></p><p>In order to determine if I can sanely scrape a website, I have to do a bit of research. How much data from a Facebook status update can we actually scrape?</p><p>Fortunately, Facebook&rsquo;s <a href=https://developers.facebook.com/docs/graph-api/reference target=_blank>Graph API documentation</a> is pretty good. We need data from the <a href=https://developers.facebook.com/docs/graph-api/reference/page target=_blank>/page</a> node, and from there, we can access data from the <a href=https://developers.facebook.com/docs/graph-api/reference/v2.4/page/feed target=_blank>/feed</a> edge.</p><p>Between the two nodes, we have access to <code>id</code>, which is a unique identifer that can be used to create a link back to the update itself (e.g. <a href=https://www.facebook.com/5281959998_10150628170209999 target=_blank>https://www.facebook.com/5281959998_10150628170209999</a>) <code>message</code>, the text of the update; <code>link</code>, the URL which the update is linking; <code>name</code>, the title of the webpage of the link, <code>type</code>, an identifier if the update is text, a photo, or a video; and <code>created_time</code>, when the update is published.</p><p>Accessing the numerical counts of <code>likes</code>, <code>comments</code>, and <code>shares</code> is less explicit in the documentation. Fortunately, <a href=http://stackoverflow.com/questions/6984526/facebook-graph-api-get-like-count-on-page-group-photos target=_blank>StackOverflow</a> has the answer: you need to request <code>likes.limit(1).summary(true)</code> instead of normal <code>likes</code>.</p><p>There&rsquo;s no indication that there&rsquo;s a Rate Limit, oddly. Since we can query 100 updates at a time, the scraper will be efficient enough that it&rsquo;s unlikely to hit any extreme API limits.</p><p>Now that we know we can get all the relevant data from the sample status update, we can build a Facebook post scraper.</p><h2 id=data-scrappy>Data Scrappy</h2><p><img src=/img/facebook-scraper/def_test.png alt></p><p><em>I have created an <a href=https://github.com/minimaxir/facebook-page-post-scraper/blob/master/examples/how_to_build_facebook_scraper.ipynb target=_blank>IPython notebook hosted on GitHub</a> with detailed code, code comments, and sample output for each step of the scraper development. I strongly recommend giving it a look.</em></p><p>First, we need to see how to actually access the API. It&rsquo;s no longer a public API, and it requires user authentication via <a href=https://developers.facebook.com/docs/facebook-login/access-tokens target=_blank>access tokens</a>. Users can get Short-Term tokens, but as their name suggests, they expire quickly, so they are not recommended. The Graph API allows a neat trick; by concatenating the App ID from a user-created App and the App Secret, you create an access token which never expires. Of course, this is a major security risk, so create a separate app for the sole purpose of scraping, and reset your API Secret if it becomes known.</p><p>Let&rsquo;s say we want to scrape the New York Times&rsquo; Facebook page. We would send a request to <a href="https://graph.facebook.com/v2.4/nytimes?access_token=XXXXX" target=_blank>https://graph.facebook.com/v2.4/nytimes?access_token=XXXXX</a> and we would get:</p><pre><code class=language-json>{
        &quot;id&quot;: &quot;5281959998&quot;, 
        &quot;name&quot;: &quot;The New York Times&quot;
}
</code></pre><p>i.e., the page metadata. Sending a request to /nytimes/feed results in what we want:</p><pre><code class=language-json>{
        &quot;data&quot;: [
            {
                &quot;created_time&quot;: &quot;2015-07-20T01:25:01+0000&quot;, 
                &quot;id&quot;: &quot;5281959998_10150628157724999&quot;, 
                &quot;message&quot;: &quot;The planned megalopolis, a metropolitan area that would be about 6 times the size of New York\u2019s, is meant to revamp northern China\u2019s economy and become a laboratory for modern urban growth.&quot;
            }, 
            {
                &quot;created_time&quot;: &quot;2015-07-19T22:55:01+0000&quot;, 
                &quot;id&quot;: &quot;5281959998_10150628161129999&quot;, 
                &quot;message&quot;: &quot;\&quot;It\u2019s safe to say that federal agencies are not where we want them to be across the board,\&quot; said President Barack Obama's top cybersecurity adviser. \&quot;We clearly need to be moving faster.\&quot;&quot;
            }
         ]

            
}
</code></pre><p>Now we get the post data. But not much of it. In Graph API v2.4, the default behavior is to return very, very little metadata for statuses in order to reduce bandwidth, with the expectation that the user will request the necessary fields.</p><p>So let&rsquo;s request <em>all</em> the fields we want. This results in a very long URL not shown here which causes the posts feed to have all the data we need:</p><pre><code class=language-json>{
    &quot;comments&quot;: {},
    &quot;summary&quot;: {
        &quot;order&quot;: &quot;ranked&quot;,
        &quot;total_count&quot;: 31
    },
    &quot;created_time&quot;: &quot;2015-07-20T01:25:01+0000&quot;,
    &quot;id&quot;: &quot;5281959998_10150628157724999&quot;,
    &quot;likes&quot;: {
        &quot;data&quot;: {},
        &quot;summary&quot;: {
            &quot;total_count&quot;: 278
        }
    },
    &quot;link&quot;: &quot;http://nyti.ms/1Jr6LhU&quot;,
    &quot;message&quot;: &quot;The planned megalopolis, a metropolitan area that would be about 6 times the size of New York’s, is meant to revamp northern China’s economy and become a laboratory for modern urban growth.&quot;,
    &quot;name&quot;: &quot;China Molds a Supercity Around Beijing, Promising to Change Lives&quot;,
    &quot;shares&quot;: {
        &quot;count&quot;: 50
    },
    &quot;type&quot;: &quot;link&quot;
}
</code></pre><h2 id=post-processing>Post Processing</h2><p>Great! Now we just have to process each post. Which is easier said than done.</p><p>If you&rsquo;re an avid Facebook user, you know that not all of these attributes are not guaranteed to exist. Status updates may not have text or links. Since we&rsquo;re making a spreadsheet with an enforced schema, we need to validate that a field exists before attempting to process it.</p><p>The &ldquo;\u2019&rdquo;s in the message correspond to a <a href=http://smartquotesforsmartpeople.com/ target=_blank>smart quote</a> apostrophe. Since this a possibility, along with other unicode characters, the message and link names must be encoded <a href=https://en.wikipedia.org/wiki/UTF-8 target=_blank>in UTF-8</a> to prevent errors.</p><p>The time format is another issue. The date follows the <a href=https://en.wikipedia.org/wiki/ISO_8601 target=_blank>ISO 8601</a> standard for UTC times. However, most spreadsheet programs will not able to parse it as a Date value. Also, since the NYT is based in the USA (specifically, New York), it may be helpful for time-based statistical analysis to convert the time to Eastern Standard Time while fixing the date format.</p><p>There&rsquo;s also an unexpected precaution that must be taken whenever scraping data sets. These APIs do not expect users to be accessing very, very old data. As a result, there&rsquo;s a high probability of the API server actually hitting an error sometime during the scrape, such as a <a href=http://www.checkupdown.com/status/E500.html target=_blank>HTTP Status 500</a> or <a href=http://www.checkupdown.com/status/E502.html target=_blank>HTTP Status 502</a>. These server errors are temporary, so a helper function must be used to attempt to retrieve data until it is actually successful.</p><h2 id=putting-it-all-together>Putting it All Together</h2><p>Now we have a full plan for scraping, we query each page of Facebook Page Statuses (100 statuses maximum per page), process all statuses on that page and writing the output to a CSV file, and navigate to the next page, and repeat until no more statuses left.</p><p>This can be done with a for-loop within a while loop. In addition, I also recommend counting the number of posts processed and taking a timestamp every-so-often to ensure that the program has not stalled.</p><p><img src=/img/facebook-scraper/cnnwoo.png alt></p><p>And that&rsquo;s it! You can access the complete scraper in this GitHub repository, along with all other scripts mentioned in this article. Once you have the CSV file, you can import it into nearly every statistical program and have fun with it. <em>(You can download a .zip of the NYTimes data <a href=https://dl.dropboxusercontent.com/u/2017402/nytimes_facebook_statuses.zip target=_blank>here</a> [4.6MB])</em></p><p>Say, for example, what would happen if we compared the Median Likes of the New York Times with a certain other journalistic website that&rsquo;s the master of social media?</p><p><img src=/img/facebook-scraper/nytimes_buzz_fb.png alt></p><p>There may be more practical reasons for analyzing data on Facebook Posts, such as quantifying the growth and success of your own page, or that of your competitors. But the data is easy to get and is very useful.</p><p>Although, in fairness, the scraper is not perfect and still has room for improvement. With CNN&rsquo;s Facebook Page post data, for example, somehow the scraper skips all posts from 2013. Although in that case, I blame Facebook.</p><hr><p><em>You can access all resources used in this blog post at this <a href=https://github.com/minimaxir/facebook-page-post-scraper target=_blank>GitHub repository</a></em>.</p><p><em>If you haven&rsquo;t, I strongly recommend looking at the <a href=https://github.com/minimaxir/facebook-page-post-scraper/blob/master/how_to_build_facebook_scraper.ipynb target=_blank>IPython Notebook</a> for more detailed coding methodology.</em></p><p><em>And, as an experiment, I&rsquo;ve made an <a href=https://github.com/minimaxir/facebook-page-post-scraper/blob/master/fb_page_data_analysis.ipynb target=_blank>IPython notebook with the R kernel</a> showing how I made the NYT-BuzzFeed chart!</em></p><div class="alert alert-note"><div>If you liked this blog post, I have set up a <a href=https://www.patreon.com/minimaxir target=_blank>Patreon</a> to fund my machine learning/deep learning/software/hardware needs for my future crazy yet cool projects, and any monetary contributions to the Patreon are appreciated and will be put to good creative use.</div></div></div><div class=article-tags><a class="badge badge-light" href=/tags/python/>Python</a>
<a class="badge badge-light" href=/tags/scraping/>Scraping</a></div><div class="media author-card" itemscope itemtype=http://schema.org/Person><img class="portrait mr-3" src="https://s.gravatar.com/avatar/28f09e3deff62333b3f32f19d3971d46?s=200')" itemprop=image alt=Avatar><div class=media-body><h5 class=card-title itemprop=name><a href=https://minimaxir.com/>Max Woolf</a></h5><h6 class=card-subtitle>Data Scientist at BuzzFeed</h6><p class=card-text itemprop=description>Ex-Apple. Carnegie Mellon graduate. Plotter of pretty charts. Former TechCrunch comment troll.</p><ul class=network-icon aria-hidden=true><li><a itemprop=sameAs href=https://twitter.com/minimaxir target=_blank rel=noopener><i class="fab fa-twitter"></i></a></li><li><a itemprop=sameAs href=https://linkedin.com/in/minimaxir target=_blank rel=noopener><i class="fab fa-linkedin"></i></a></li><li><a itemprop=sameAs href=https://youtube.com/minimaxir target=_blank rel=noopener><i class="fab fa-youtube"></i></a></li><li><a itemprop=sameAs href=https://twitch.tv/minimaxir target=_blank rel=noopener><i class="fab fa-twitch"></i></a></li><li><a itemprop=sameAs href=mailto:max@minimaxir.com><i class="fas fa-envelope"></i></a></li></ul></div></div><div class=article-widget><div class=post-nav><div class=post-nav-item><div class=meta-nav>Next</div><a href=/2015/08/nyc-map/ rel=next>Plotting a Map of New York City Using Only Taxi Location Data</a></div><div class=post-nav-item><div class=meta-nav>Previous</div><a href=/2015/06/cars-2/ rel=prev>Why is the Most-Viewed Gaming Video on YouTube About Cars 2?</a></div></div></div><section id=comments><div id=disqus_thread></div><script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return;}
var d=document,s=d.createElement('script');s.async=true;s.src='//'+"minimaxir"+'.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></section></div></article><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js integrity="sha256-aYTdUrn6Ow1DDgh5JTc3aDGnnju48y/1c8s1dgkYPQ8=" crossorigin=anonymous></script><script src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/r.min.js></script><script>hljs.initHighlightingOnLoad();</script><script src=/js/academic.min.bc1d5e4f014b8d38d75521ad1ae2ab18.js></script><div class=container><footer class=site-footer><p class=powered-by>Copyright Max Woolf &copy; 2019 &middot;
Powered by the
<a href=https://sourcethemes.com/academic/ target=_blank rel=noopener>Academic theme</a> for
<a href=https://gohugo.io target=_blank rel=noopener>Hugo</a>.
<span class=float-right aria-hidden=true><a href=# id=back_to_top><span class=button_icon><i class="fas fa-chevron-up fa-2x"></i></span></a></span></p></footer></div><div id=modal class="modal fade" role=dialog><div class=modal-dialog><div class=modal-content><div class=modal-header><h5 class=modal-title>Cite</h5><button type=button class=close data-dismiss=modal aria-label=Close>
<span aria-hidden=true>&times;</span></button></div><div class=modal-body><pre><code class="tex hljs"></code></pre></div><div class=modal-footer><a class="btn btn-outline-primary my-1 js-copy-cite" href=# target=_blank><i class="fas fa-copy"></i>Copy</a>
<a class="btn btn-outline-primary my-1 js-download-cite" href=# target=_blank><i class="fas fa-download"></i>Download</a><div id=modal-error></div></div></div></div></div></body></html>